<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio & Dashboard | Infinity Mutual Funds</title>
    
    <!-- Chart.js Library for Stock Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    
    <!-- Live Clock in Title -->
    <script>
        function updateTitleTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-IN', {hour: '2-digit', minute:'2-digit'});
            document.title = `ðŸ“Š ${timeStr} | Portfolio & Dashboard | Infinity Mutual Funds`;
        }
        setInterval(updateTitleTime, 60000);
        updateTitleTime();
    </script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Enhanced Live Theme with Stock Tracker Styles -->
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --profit-gradient: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
            --loss-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            --live-gradient: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            --background-gradient: linear-gradient(135deg, #0a0f2e 0%, #1a1f4e 100%);
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: var(--background-gradient);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            padding-top: 40px;
        }
        
        /* Animated Background */
        .animated-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 40% 80%, rgba(0, 210, 255, 0.1) 0%, transparent 40%);
            animation: backgroundFloat 20s ease-in-out infinite alternate;
        }
        
        @keyframes backgroundFloat {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(20px, 20px) scale(1.02); }
        }
        
        /* ====== FIXED: Live Status Bar ====== */
        .live-status-bar {
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: 2px solid #00d2ff;
            backdrop-filter: blur(10px);
            font-family: 'Courier New', monospace;
            height: 40px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .live-status-left {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .live-status-section {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .live-label {
            font-size: 10px;
            font-weight: 600;
            color: #00d2ff;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .live-value {
            font-size: 11px;
            font-weight: 500;
            color: #ffffff;
        }
        
        .nifty-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nifty-value {
            font-size: 11px;
            font-weight: 600;
            color: #ffffff;
        }
        
        .nifty-change {
            font-size: 10px;
            font-weight: 600;
            padding: 1px 5px;
            border-radius: 3px;
        }
        
        .nifty-change.positive {
            background: rgba(0, 176, 155, 0.2);
            color: #00b09b;
        }
        
        .nifty-change.negative {
            background: rgba(255, 65, 108, 0.2);
            color: #ff416c;
        }
        
        /* ====== FIXED: Navbar ====== */
        .navbar {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 0;
            position: fixed;
            top: 40px;
            left: 0;
            width: 100%;
            z-index: 999;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo {
            width: 36px;
            height: 36px;
            background: var(--primary-gradient);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .brand-name {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .current-date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-left: 15px;
            font-weight: 400;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-menu {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
        }
        
        .nav-link.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        /* ====== Main Content Area ====== */
        main {
            margin-top: 120px;
            padding-bottom: 50px;
        }
        
        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .tab-btn {
            background: transparent;
            color: var(--text-secondary);
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .tab-btn.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ====== DASHBOARD TAB STYLES ====== */
        /* Dashboard Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: transform 0.3s;
            color: #1e293b;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }
        
        .stat-change {
            font-size: 14px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .stat-change.negative {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #64748b;
        }
        
        /* Dashboard Content Layout */
        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .dashboard-card {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: #1e293b;
        }
        
        .dashboard-card h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 25px;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .dashboard-card h2 i {
            color: #3b82f6;
        }
        
        .portfolio-chart {
            margin-top: 20px;
        }
        
        .chart-placeholder {
            height: 250px;
            background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            font-size: 16px;
        }
        
        /* Activity List */
        .activity-list {
            list-style: none;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(226, 232, 240, 0.7);
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background-color: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
        }
        
        .activity-details h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .activity-details p {
            font-size: 13px;
            color: #64748b;
        }
        
        .activity-time {
            margin-left: auto;
            font-size: 12px;
            color: #94a3b8;
        }
        
        /* Funds List */
        .fund-list {
            margin-top: 20px;
        }
        
        .fund-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(226, 232, 240, 0.7);
        }
        
        .fund-item:last-child {
            border-bottom: none;
        }
        
        .fund-name {
            font-weight: 500;
        }
        
        .fund-amount {
            font-weight: 600;
            color: #1e293b;
        }
        
        .fund-change {
            font-size: 13px;
            font-weight: 600;
        }
        
        .positive {
            color: #10b981;
        }
        
        .negative {
            color: #ef4444;
        }
        
        /* ====== STOCK TRACKER STYLES ====== */
        .stock-search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stock-search {
            flex: 1;
            display: flex;
            gap: 10px;
        }
        
        .stock-search input {
            flex: 1;
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            font-size: 14px;
            background: white;
            color: #1e293b;
        }
        
        .timeframe-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .time-btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #64748b;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .time-btn:hover {
            background: #f1f5f9;
        }
        
        .time-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .chart-container {
            height: 350px;
            width: 100%;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px;
            padding: 15px;
            position: relative;
        }
        
        .stock-info {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .stock-info h3 {
            color: #1e293b;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .stock-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .stock-stats > div {
            background: white;
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .stock-stats strong {
            font-size: 18px;
            color: #1e293b;
        }
        
        .watchlist-container {
            margin-top: 30px;
        }
        
        .watchlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .watchlist-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .watchlist-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .watchlist-symbol {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 5px;
        }
        
        .watchlist-price {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .watchlist-change {
            font-size: 13px;
            font-weight: 600;
        }
        
        /* ====== PORTFOLIO TAB STYLES ====== */
        /* Enhanced Portfolio Cards */
        .portfolio-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .summary-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .summary-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }
        
        .summary-card h3 {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 15px;
        }
        
        .amount {
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
            color: white;
        }
        
        .change {
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .change.positive {
            background: rgba(0, 176, 155, 0.2);
            color: #00b09b;
        }
        
        .change.negative {
            background: rgba(255, 65, 108, 0.2);
            color: #ff416c;
        }
        
        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* SIP Live Indicators */
        .sip-indicators {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .sip-indicators h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: white;
        }
        
        .sip-indicator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .sip-indicator {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sip-indicator:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .sip-icon {
            width: 50px;
            height: 50px;
            background: rgba(0, 210, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #00d2ff;
            font-size: 20px;
        }
        
        .sip-name {
            font-weight: 600;
            color: white;
        }
        
        .sip-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }
        
        /* Portfolio Actions */
        .portfolio-actions {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }
        
        /* Enhanced Table */
        .portfolio-table-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .table-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }
        
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .portfolio-table th {
            background: rgba(0, 0, 0, 0.3);
            padding: 18px;
            text-align: left;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .portfolio-table td {
            padding: 18px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.8);
        }
        
        .portfolio-table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        /* Today's Special Section */
        .today-special {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 193, 7, 0.1));
            border-left: 4px solid #ff6b6b;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        /* Live Market Status */
        .market-status {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 10000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
            
            .portfolio-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding-top: 60px;
            }
            
            .navbar {
                top: 60px;
            }
            
            main {
                margin-top: 140px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .portfolio-summary {
                grid-template-columns: 1fr;
            }
            
            .tab-navigation {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                flex: 1;
                min-width: 120px;
                justify-content: center;
            }
            
            .portfolio-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .stock-stats {
                grid-template-columns: 1fr;
            }
            
            .watchlist-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-background"></div>

    <!-- ====== FIXED: Live Status Bar ====== -->
    <div class="live-status-bar" id="liveStatusBar">
        <div class="live-status-left">
            <div class="live-status-section">
                <div class="live-label">LIVE DATA</div>
                <div class="live-value">REALTIME TRADING</div>
            </div>
            
            <div class="live-status-section">
                <div class="live-label">TIME</div>
                <div class="live-value" id="currentDateTime">Friday, 2 January 2026, 12:21:39 pm</div>
            </div>
            
            <div class="live-status-section">
                <div class="live-label">NIFTY</div>
                <div class="nifty-container">
                    <span class="nifty-value" id="niftyValue">22416.07</span>
                    <span class="nifty-change positive" id="niftyChange">+0.00%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ====== FIXED: Navbar ====== -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <div class="logo">âˆž</div>
                <div>
                    <div class="brand-name">Infinity Mutual Funds</div>
                    <div class="current-date" id="currentDate">Friday, 2 January 2026</div>
                </div>
            </div>
            <div class="nav-menu">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-link active" id="portfolioPageLink">
                    <i class="fas fa-chart-pie"></i>
                    <span>Portfolio & Dashboard</span>
                </a>
                <a href="market.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Market</span>
                </a>
                <a href="transactions.html" class="nav-link">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transactions</span>
                </a>
                <a href="reports.html" class="nav-link">
                    <i class="fas fa-file-alt"></i>
                    <span>Reports</span>
                </a>
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- ====== Main Content ====== -->
    <main class="container">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                Dashboard
            </button>
            <button class="tab-btn" data-tab="portfolio">
                <i class="fas fa-chart-pie"></i>
                Portfolio
            </button>
            <button class="tab-btn" data-tab="stocks">
                <i class="fas fa-chart-line"></i>
                Stock Tracker
            </button>
            <button class="tab-btn" data-tab="funds">
                <i class="fas fa-wallet"></i>
                Funds
            </button>
        </div>

        <!-- Today's Special Announcement -->
        <div class="today-special">
            <i class="fas fa-bullhorn fa-lg" style="color: #ff6b6b;"></i>
            <div>
                <strong>Live Stock Tracker Added!</strong> Now track individual stocks like TCS with real-time mock data and interactive charts.
            </div>
        </div>

        <!-- ====== DASHBOARD TAB CONTENT ====== -->
        <div class="tab-content active" id="dashboardTab">
            <!-- Dashboard Header -->
            <div class="page-header">
                <h1>Dashboard Overview</h1>
                <p>Your complete investment dashboard with real-time updates</p>
                <div class="last-updated">
                    <span id="lastUpdateTime">Last updated: 12:21:39 pm</span>
                    <button class="refresh-btn" id="refreshDashboard">
                        <i class="fas fa-sync-alt"></i> Refresh Now
                    </button>
                </div>
            </div>

            <!-- Dashboard Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-change positive">+12.5%</div>
                    </div>
                    <div class="stat-value" id="portfolioValue">$245,850.75</div>
                    <div class="stat-label">Total Portfolio Value</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-change positive">+5.2%</div>
                    </div>
                    <div class="stat-value" id="totalInvested">$198,500.00</div>
                    <div class="stat-label">Total Invested</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-change positive">+8.3%</div>
                    </div>
                    <div class="stat-value" id="totalReturns">$47,350.75</div>
                    <div class="stat-label">Total Returns</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-change">8</div>
                    </div>
                    <div class="stat-value" id="activeFunds">8</div>
                    <div class="stat-label">Active Funds</div>
                </div>
            </div>

            <!-- Dashboard Main Content -->
            <div class="dashboard-content">
                <!-- Left Column -->
                <div>
                    <!-- Portfolio Performance -->
                    <div class="dashboard-card">
                        <h2><i class="fas fa-chart-pie"></i> Portfolio Performance</h2>
                        <div class="portfolio-chart">
                            <div class="chart-placeholder">
                                <div style="text-align: center;">
                                    <i class="fas fa-chart-bar" style="font-size: 48px; margin-bottom: 15px; color: #94a3b8;"></i>
                                    <div>Portfolio Growth Chart</div>
                                    <div style="font-size: 14px; margin-top: 5px;">Last 12 Months: +12.5% Growth</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Transactions -->
                    <div class="dashboard-card" style="margin-top: 30px;">
                        <h2><i class="fas fa-history"></i> Recent Transactions</h2>
                        <ul class="activity-list">
                            <li class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-download"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>SIP Investment</h4>
                                    <p>Monthly SIP in Equity Fund</p>
                                </div>
                                <div class="activity-time">Today, 9:30 AM</div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-exchange-alt"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Fund Switch</h4>
                                    <p>Debt to Hybrid Fund</p>
                                </div>
                                <div class="activity-time">Yesterday, 2:15 PM</div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-plus"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>New Investment</h4>
                                    <p>Added to International Fund</p>
                                </div>
                                <div class="activity-time">Oct 28, 2023</div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Statement Generated</h4>
                                    <p>Monthly portfolio statement</p>
                                </div>
                                <div class="activity-time">Oct 25, 2023</div>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <!-- Your Funds -->
                    <div class="dashboard-card">
                        <h2><i class="fas fa-wallet"></i> Your Funds</h2>
                        <div class="fund-list">
                            <div class="fund-item">
                                <div class="fund-name">Equity Growth Fund</div>
                                <div class="fund-amount">$124,500</div>
                                <div class="fund-change positive">+5.2%</div>
                            </div>
                            <div class="fund-item">
                                <div class="fund-name">Debt Income Fund</div>
                                <div class="fund-amount">$68,300</div>
                                <div class="fund-change positive">+3.1%</div>
                            </div>
                            <div class="fund-item">
                                <div class="fund-name">Hybrid Balanced Fund</div>
                                <div class="fund-amount">$42,750</div>
                                <div class="fund-change positive">+2.8%</div>
                            </div>
                            <div class="fund-item">
                                <div class="fund-name">International Fund</div>
                                <div class="fund-amount">$10,300</div>
                                <div class="fund-change negative">-1.2%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Upcoming Tasks -->
                    <div class="dashboard-card" style="margin-top: 30px;">
                        <h2><i class="fas fa-tasks"></i> Upcoming Tasks</h2>
                        <ul class="activity-list">
                            <li class="activity-item">
                                <div class="activity-icon" style="background-color: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>SIP Payment Due</h4>
                                    <p>Monthly SIP due on Nov 5</p>
                                </div>
                                <div class="activity-time">In 3 days</div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon" style="background-color: rgba(59, 130, 246, 0.1); color: #3b82f6;">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Portfolio Review</h4>
                                    <p>Quarterly review meeting</p>
                                </div>
                                <div class="activity-time">Nov 15</div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon" style="background-color: rgba(124, 58, 237, 0.1); color: #7c3aed;">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="activity-details">
                                    <h4>Performance Analysis</h4>
                                    <p>Q4 performance review</p>
                                </div>
                                <div class="activity-time">Nov 20</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ====== PORTFOLIO TAB CONTENT ====== -->
        <div class="tab-content" id="portfolioTab">
            <!-- Portfolio Header -->
            <div class="page-header">
                <h1>My Portfolio</h1>
                <p>Manage and track all your mutual fund investments in real-time</p>
                <div class="last-updated">
                    <span id="portfolioLastUpdate">Last updated: 12:21:39 pm</span>
                    <button class="refresh-btn" id="refreshPortfolio">
                        <i class="fas fa-sync-alt"></i> Refresh Now
                    </button>
                </div>
            </div>

            <!-- Live Market Status -->
            <div class="market-status">
                <div class="status-indicator live">
                    <i class="fas fa-circle"></i>
                    <span>Market Open: Live Data Streaming</span>
                </div>
                <div class="market-time">
                    <i class="far fa-clock"></i>
                    <span>09:15 AM - 03:30 PM (Live)</span>
                </div>
            </div>

            <!-- Portfolio Summary Cards -->
            <div class="portfolio-summary">
                <div class="summary-card">
                    <h3>Total Value</h3>
                    <p class="amount" id="totalValue">â‚¹24,78,560</p>
                    <p class="change positive">+2.4% today</p>
                    <div class="live-indicator">
                        <i class="fas fa-chart-line"></i>
                        <span>Live Updates Active</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h3>Total Gain</h3>
                    <p class="amount" id="totalGain">â‚¹2,15,400</p>
                    <p class="change positive">+15.8% overall</p>
                </div>
                <div class="summary-card">
                    <h3>Funds Held</h3>
                    <p class="amount" id="fundsCount">12</p>
                    <p class="info">across 4 AMCs</p>
                </div>
            </div>

            <!-- SIP Live Indicators -->
            <div class="sip-indicators">
                <h3><i class="fas fa-bolt"></i> Live SIP Status</h3>
                <div class="sip-indicator-grid" id="sipIndicators">
                    <!-- SIP indicators will be populated dynamically -->
                </div>
            </div>

            <!-- Portfolio Actions -->
            <div class="portfolio-actions">
                <button class="btn btn-primary" id="addInvestment">
                    <i class="fas fa-plus"></i>
                    <span>Add Investment</span>
                </button>
                <button class="btn btn-outline" id="importCAS">
                    <i class="fas fa-file-import"></i>
                    <span>Import CAS</span>
                </button>
                <button class="btn btn-outline" id="rebalancePortfolio">
                    <i class="fas fa-balance-scale"></i>
                    <span>Rebalance</span>
                </button>
            </div>

            <!-- Portfolio Table -->
            <div class="portfolio-table-container">
                <div class="table-header">
                    <h3>Your Holdings</h3>
                </div>
                <table class="portfolio-table" id="portfolioTable">
                    <thead>
                        <tr>
                            <th>Fund Name</th>
                            <th>AMC</th>
                            <th>Units</th>
                            <th>Current NAV</th>
                            <th>Current Value</th>
                            <th>Gain/Loss</th>
                        </tr>
                    </thead>
                    <tbody id="portfolioTbody">
                        <!-- Portfolio data will be populated dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ====== STOCK TRACKER TAB CONTENT ====== -->
        <div class="tab-content" id="stocksTab">
            <!-- Stock Tracker Header -->
            <div class="page-header">
                <h1>Stock Tracker</h1>
                <p>Real-time tracking for individual stocks with interactive charts</p>
                <div class="last-updated">
                    <span id="stockLastUpdate">Last updated: Loading...</span>
                    <button class="refresh-btn" id="refreshStockData">
                        <i class="fas fa-sync-alt"></i> Refresh Now
                    </button>
                </div>
            </div>

            <!-- Live Market Status -->
            <div class="market-status">
                <div class="status-indicator live">
                    <i class="fas fa-circle" style="color: #10b981;"></i>
                    <span>Stock Market Open: Live Mock Data</span>
                </div>
                <div class="market-time">
                    <i class="far fa-clock"></i>
                    <span>Using Mock Data - Ready for API Integration</span>
                </div>
            </div>

            <!-- Stock Tracker Card -->
            <div class="dashboard-card">
                <h2><i class="fas fa-search"></i> Stock Tracker</h2>
                
                <!-- Stock Search -->
                <div class="stock-search-container">
                    <div class="stock-search">
                        <input type="text" id="stockSymbol" placeholder="Enter stock symbol (e.g., TCS, INFY, RELIANCE)" value="TCS">
                        <button class="btn btn-primary" id="fetchStockData">
                            <i class="fas fa-chart-line"></i> Load Data
                        </button>
                    </div>
                </div>

                <!-- Timeframe Selector -->
                <div class="timeframe-selector">
                    <button class="time-btn active" data-period="1D">1 Day</button>
                    <button class="time-btn" data-period="1W">1 Week</button>
                    <button class="time-btn" data-period="1M">1 Month</button>
                    <button class="time-btn" data-period="3M">3 Months</button>
                    <button class="time-btn" data-period="6M">6 Months</button>
                    <button class="time-btn" data-period="1Y">1 Year</button>
                </div>

                <!-- Chart Container -->
                <div class="chart-container">
                    <canvas id="stockChart"></canvas>
                </div>

                <!-- Stock Information -->
                <div class="stock-info">
                    <h3 id="stockName">Tata Consultancy Services Ltd.</h3>
                    <div class="stock-stats">
                        <div>
                            Current Price: <strong id="stockPrice">â‚¹4,250.50</strong>
                        </div>
                        <div>
                            Daily Change: <span id="stockChange" class="positive">+2.5%</span>
                        </div>
                        <div>
                            Volume: <span id="stockVolume">5.2M</span>
                        </div>
                        <div>
                            Market Cap: <span id="marketCap">â‚¹15.2T</span>
                        </div>
                        <div>
                            52W High: <span id="weekHigh">â‚¹4,350.75</span>
                        </div>
                        <div>
                            52W Low: <span id="weekLow">â‚¹3,150.25</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Watchlist -->
                <div class="watchlist-container">
                    <h3><i class="fas fa-star"></i> Your Watchlist</h3>
                    <div class="watchlist-grid" id="watchlistGrid">
                        <!-- Watchlist items will be populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- API Integration Note -->
            <div class="today-special" style="margin-top: 30px;">
                <i class="fas fa-info-circle fa-lg" style="color: #3b82f6;"></i>
                <div>
                    <strong>API Integration Ready:</strong> This dashboard is using mock data. To connect to real-time data, sign up for a free API key from <a href="https://www.alphavantage.co" target="_blank" style="color: #3b82f6; text-decoration: underline;">Alpha Vantage</a> or <a href="https://twelvedata.com" target="_blank" style="color: #3b82f6; text-decoration: underline;">Twelve Data</a> and replace the mock data function with real API calls.
                </div>
            </div>
        </div>

        <!-- ====== FUNDS TAB CONTENT ====== -->
        <div class="tab-content" id="fundsTab">
            <div class="page-header">
                <h1>My Funds</h1>
                <p>Detailed view of all your mutual fund investments</p>
            </div>
            <div class="dashboard-card">
                <h2><i class="fas fa-wallet"></i> All Funds</h2>
                <p style="color: #64748b; margin-bottom: 20px;">Coming soon - Detailed fund analysis</p>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="updateToast">
        <div class="toast-content">
            <i class="fas fa-sync-alt fa-spin"></i>
            <span>Data updated successfully!</span>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // User data
        let userData = {
            name: "John Marpung",
            email: "john@gmail.com",
            portfolioValue: 245850.75,
            totalInvested: 198500,
            totalReturns: 47350.75,
            monthlySIP: 2500,
            activeFunds: 8
        };

        // Portfolio data
        const portfolioData = [
            {
                name: "HDFC Top 100 Fund",
                amc: "HDFC Mutual Fund",
                units: "450.25",
                nav: "â‚¹615.20",
                value: "â‚¹2,76,834",
                gain: "+18.2%",
                sip: true
            },
            {
                name: "ICICI Pru Bluechip Fund",
                amc: "ICICI Prudential",
                units: "320.50",
                nav: "â‚¹560.75",
                value: "â‚¹1,79,680",
                gain: "+16.8%",
                sip: true
            },
            {
                name: "SBI Small Cap Fund",
                amc: "SBI Mutual Fund",
                units: "150.75",
                nav: "â‚¹120.25",
                value: "â‚¹18,128",
                gain: "+40.8%",
                sip: false
            },
            {
                name: "Axis Long Term Equity",
                amc: "Axis Mutual Fund",
                units: "180.00",
                nav: "â‚¹410.25",
                value: "â‚¹73,845",
                gain: "+20.5%",
                sip: true
            },
            {
                name: "Mirae Asset Emerging",
                amc: "Mirae Asset",
                units: "220.40",
                nav: "â‚¹350.20",
                value: "â‚¹77,168",
                gain: "+24.8%",
                sip: true
            }
        ];

        // Stock tracker data
        const stockData = {
            TCS: {
                name: "Tata Consultancy Services Ltd.",
                currentPrice: 4250.50,
                change: 2.5,
                volume: "5.2M",
                marketCap: "â‚¹15.2T",
                weekHigh: 4350.75,
                weekLow: 3150.25,
                sector: "IT Services"
            },
            INFY: {
                name: "Infosys Ltd.",
                currentPrice: 1850.75,
                change: 1.8,
                volume: "8.5M",
                marketCap: "â‚¹7.8T",
                weekHigh: 1950.25,
                weekLow: 1450.50,
                sector: "IT Services"
            },
            RELIANCE: {
                name: "Reliance Industries Ltd.",
                currentPrice: 2950.25,
                change: 0.8,
                volume: "12.5M",
                marketCap: "â‚¹20.5T",
                weekHigh: 3050.75,
                weekLow: 2250.25,
                sector: "Conglomerate"
            },
            HDFCBANK: {
                name: "HDFC Bank Ltd.",
                currentPrice: 1750.50,
                change: -0.5,
                volume: "15.2M",
                marketCap: "â‚¹12.8T",
                weekHigh: 1850.25,
                weekLow: 1350.75,
                sector: "Banking"
            },
            ICICIBANK: {
                name: "ICICI Bank Ltd.",
                currentPrice: 1125.75,
                change: 1.2,
                volume: "18.5M",
                marketCap: "â‚¹8.2T",
                weekHigh: 1200.25,
                weekLow: 850.50,
                sector: "Banking"
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                window.location.href = 'index.html';
                return;
            }

            // Load saved data
            const savedData = JSON.parse(localStorage.getItem('infinityUserData'));
            if (savedData) {
                userData = { ...userData, ...savedData };
            }

            // Initialize UI
            initializeUI();
            setupEventListeners();
            
            // Update date time
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });

        // Initialize UI
        function initializeUI() {
            // Update dashboard stats
            updateDashboardStats();
            
            // Load portfolio data
            loadPortfolioData();
            
            // Load SIP indicators
            loadSIPIndicators();
            
            // Initialize stock tracker
            initializeStockTracker();
        }

        // Update dashboard statistics
        function updateDashboardStats() {
            document.getElementById('portfolioValue').textContent = 
                `$${userData.portfolioValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            document.getElementById('totalInvested').textContent = 
                `$${userData.totalInvested.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            document.getElementById('totalReturns').textContent = 
                `$${userData.totalReturns.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            document.getElementById('activeFunds').textContent = userData.activeFunds;
            
            // Update portfolio tab values
            document.getElementById('totalValue').textContent = 
                `$${userData.portfolioValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            const gain = userData.portfolioValue - userData.totalInvested;
            const gainPercentage = ((gain / userData.totalInvested) * 100).toFixed(1);
            document.getElementById('totalGain').textContent = 
                `$${gain.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            document.getElementById('fundsCount').textContent = portfolioData.length;
        }

        // Load portfolio data
        function loadPortfolioData() {
            const tbody = document.getElementById('portfolioTbody');
            tbody.innerHTML = '';
            
            portfolioData.forEach(fund => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${fund.name}</td>
                    <td>${fund.amc}</td>
                    <td>${fund.units}</td>
                    <td>${fund.nav}</td>
                    <td><strong>${fund.value}</strong></td>
                    <td class="${fund.gain.includes('+') ? 'positive' : 'negative'}">${fund.gain}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load SIP indicators
        function loadSIPIndicators() {
            const sipContainer = document.getElementById('sipIndicators');
            sipContainer.innerHTML = '';
            
            const sipFunds = portfolioData.filter(f => f.sip);
            sipFunds.forEach(fund => {
                const indicator = document.createElement('div');
                indicator.className = 'sip-indicator';
                indicator.innerHTML = `
                    <div class="sip-icon">
                        <i class="fas fa-rupee-sign"></i>
                    </div>
                    <div>
                        <div class="sip-name">${fund.name.split(' ')[0]}</div>
                        <div class="sip-status">
                            <i class="fas fa-circle" style="color: #00ff88; font-size: 0.8em;"></i>
                            <span>Active SIP</span>
                        </div>
                    </div>
                `;
                sipContainer.appendChild(indicator);
            });
        }

        // Initialize Stock Tracker
        function initializeStockTracker() {
            // Load default stock (TCS)
            fetchStockData('TCS', '1M');
            
            // Load watchlist
            loadWatchlist();
        }

        // Generate mock stock data for different timeframes
        function generateMockStockData(symbol, period) {
            const basePrice = stockData[symbol]?.currentPrice || 1000;
            let dataPoints = 30;
            let labels = [];
            let prices = [];
            
            // Generate dates based on period
            const now = new Date();
            
            switch(period) {
                case '1D':
                    dataPoints = 24; // Hourly data for 24 hours
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setHours(date.getHours() - i);
                        labels.push(date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}));
                        // Generate price with some variation
                        const variation = (Math.random() - 0.5) * 2;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
                    
                case '1W':
                    dataPoints = 7; // Daily data for 7 days
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setDate(date.getDate() - i);
                        labels.push(date.toLocaleDateString([], {month: 'short', day: 'numeric'}));
                        const variation = (Math.random() - 0.5) * 5;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
                    
                case '1M':
                    dataPoints = 30; // Daily data for 30 days
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setDate(date.getDate() - i);
                        labels.push(date.toLocaleDateString([], {month: 'short', day: 'numeric'}));
                        const variation = (Math.random() - 0.5) * 10;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
                    
                case '3M':
                    dataPoints = 13; // Weekly data for 13 weeks
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setDate(date.getDate() - (i * 7));
                        labels.push(date.toLocaleDateString([], {month: 'short', day: 'numeric'}));
                        const variation = (Math.random() - 0.5) * 15;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
                    
                case '6M':
                    dataPoints = 26; // Bi-weekly data
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setDate(date.getDate() - (i * 14));
                        labels.push(date.toLocaleDateString([], {month: 'short', day: 'numeric'}));
                        const variation = (Math.random() - 0.5) * 20;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
                    
                case '1Y':
                    dataPoints = 12; // Monthly data for 12 months
                    for (let i = dataPoints - 1; i >= 0; i--) {
                        const date = new Date(now);
                        date.setMonth(date.getMonth() - i);
                        labels.push(date.toLocaleDateString([], {month: 'short', year: '2-digit'}));
                        const variation = (Math.random() - 0.5) * 30;
                        const price = basePrice + (variation * basePrice * 0.01);
                        prices.push(price);
                    }
                    break;
            }
            
            return {
                labels: labels,
                prices: prices,
                period: period,
                symbol: symbol
            };
        }

        // Fetch stock data
        let currentStockChart = null;
        
        async function fetchStockData(symbol, period) {
            const stockSymbol = symbol.toUpperCase();
            const stockInfo = stockData[stockSymbol];
            
            if (!stockInfo) {
                showToast(`Stock symbol "${symbol}" not found in mock data`);
                return;
            }
            
            showToast(`Loading ${period} data for ${stockSymbol}...`);
            
            // Update stock info
            document.getElementById('stockName').textContent = stockInfo.name;
            document.getElementById('stockPrice').textContent = `â‚¹${stockInfo.currentPrice.toFixed(2)}`;
            document.getElementById('stockChange').textContent = `${stockInfo.change >= 0 ? '+' : ''}${stockInfo.change.toFixed(2)}%`;
            document.getElementById('stockChange').className = stockInfo.change >= 0 ? 'positive' : 'negative';
            document.getElementById('stockVolume').textContent = stockInfo.volume;
            document.getElementById('marketCap').textContent = stockInfo.marketCap;
            document.getElementById('weekHigh').textContent = `â‚¹${stockInfo.weekHigh.toFixed(2)}`;
            document.getElementById('weekLow').textContent = `â‚¹${stockInfo.weekLow.toFixed(2)}`;
            
            // Generate mock chart data
            const chartData = generateMockStockData(stockSymbol, period);
            
            // Update chart
            updateStockChart(chartData);
            
            // Update last updated time
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-IN', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            document.getElementById('stockLastUpdate').textContent = `Last updated: ${timeStr}`;
            
            // Add to watchlist if not already there
            addToWatchlist(stockSymbol);
        }

        // Update stock chart
        function updateStockChart(data) {
            const ctx = document.getElementById('stockChart').getContext('2d');
            
            // Destroy previous chart if exists
            if (currentStockChart) {
                currentStockChart.destroy();
            }
            
            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(102, 126, 234, 0.3)');
            gradient.addColorStop(1, 'rgba(102, 126, 234, 0)');
            
            currentStockChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: `${data.symbol} Price`,
                        data: data.prices,
                        borderColor: '#667eea',
                        backgroundColor: gradient,
                        borderWidth: 2,
                        pointRadius: 3,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                color: '#1e293b',
                                font: {
                                    size: 12,
                                    weight: '600'
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return `${data.symbol}: â‚¹${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                color: '#64748b',
                                maxTicksLimit: 10
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                color: '#64748b',
                                callback: function(value) {
                                    return 'â‚¹' + value.toLocaleString('en-IN');
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // Load watchlist
        function loadWatchlist() {
            const watchlistGrid = document.getElementById('watchlistGrid');
            watchlistGrid.innerHTML = '';
            
            // Default watchlist
            const defaultWatchlist = ['TCS', 'INFY', 'RELIANCE', 'HDFCBANK'];
            
            defaultWatchlist.forEach(symbol => {
                const stock = stockData[symbol];
                if (stock) {
                    const watchlistItem = document.createElement('div');
                    watchlistItem.className = 'watchlist-item';
                    watchlistItem.setAttribute('data-symbol', symbol);
                    watchlistItem.innerHTML = `
                        <div class="watchlist-symbol">${symbol}</div>
                        <div class="watchlist-price">â‚¹${stock.currentPrice.toFixed(2)}</div>
                        <div class="watchlist-change ${stock.change >= 0 ? 'positive' : 'negative'}">
                            ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%
                        </div>
                    `;
                    
                    // Add click event to load this stock
                    watchlistItem.addEventListener('click', function() {
                        document.getElementById('stockSymbol').value = symbol;
                        fetchStockData(symbol, '1M');
                        
                        // Set active timeframe button
                        document.querySelectorAll('.time-btn').forEach(btn => {
                            btn.classList.remove('active');
                            if (btn.getAttribute('data-period') === '1M') {
                                btn.classList.add('active');
                            }
                        });
                    });
                    
                    watchlistGrid.appendChild(watchlistItem);
                }
            });
        }

        // Add stock to watchlist
        function addToWatchlist(symbol) {
            // In a real app, you would save this to localStorage or backend
            // For now, we just update the UI if the stock is clicked
            console.log(`Added ${symbol} to watchlist`);
        }

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            
            const dateStr = now.toLocaleDateString('en-IN', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const timeStr = now.toLocaleTimeString('en-IN', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            
            document.getElementById('currentDate').textContent = dateStr;
            document.getElementById('currentDateTime').textContent = `${dateStr}, ${timeStr}`;
            
            // Update last update times
            document.querySelectorAll('#lastUpdateTime, #portfolioLastUpdate').forEach(el => {
                el.textContent = `Last updated: ${timeStr}`;
            });
            
            // Update NIFTY value
            updateNiftyValue();
        }

        // Update NIFTY value
        function updateNiftyValue() {
            const niftyValue = document.getElementById('niftyValue');
            const niftyChange = document.getElementById('niftyChange');
            
            const currentValue = parseFloat(niftyValue.textContent.replace(/,/g, ''));
            const change = (Math.random() - 0.5) * 2;
            const newValue = currentValue + change;
            
            niftyValue.textContent = newValue.toFixed(2);
            
            const changePercent = (change / currentValue * 100).toFixed(2);
            niftyChange.textContent = `${changePercent >= 0 ? '+' : ''}${changePercent}%`;
            niftyChange.className = changePercent >= 0 ? 'nifty-change positive' : 'nifty-change negative';
        }

        // Setup event listeners
        function setupEventListeners() {
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab button
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId + 'Tab') {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // Refresh buttons
            document.getElementById('refreshDashboard').addEventListener('click', function() {
                refreshData(this, 'Dashboard');
            });
            
            document.getElementById('refreshPortfolio').addEventListener('click', function() {
                refreshData(this, 'Portfolio');
            });
            
            document.getElementById('refreshStockData').addEventListener('click', function() {
                const symbol = document.getElementById('stockSymbol').value;
                const activePeriod = document.querySelector('.time-btn.active').getAttribute('data-period');
                fetchStockData(symbol, activePeriod);
            });

            // Portfolio actions
            document.getElementById('addInvestment').addEventListener('click', function() {
                showToast('Add investment feature coming soon!');
            });
            
            document.getElementById('importCAS').addEventListener('click', function() {
                showToast('CAS import feature coming soon!');
            });
            
            document.getElementById('rebalancePortfolio').addEventListener('click', function() {
                showToast('Portfolio rebalance feature coming soon!');
            });

            // Portfolio page link
            document.getElementById('portfolioPageLink').addEventListener('click', function(e) {
                e.preventDefault();
                // Switch to portfolio tab
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('.tab-btn[data-tab="portfolio"]').classList.add('active');
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.id === 'portfolioTab') {
                        content.classList.add('active');
                    }
                });
            });

            // Stock tracker events
            document.getElementById('fetchStockData').addEventListener('click', function() {
                const symbol = document.getElementById('stockSymbol').value;
                const activePeriod = document.querySelector('.time-btn.active').getAttribute('data-period');
                fetchStockData(symbol, activePeriod);
            });

            // Timeframe buttons
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active button
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Fetch data for selected timeframe
                    const symbol = document.getElementById('stockSymbol').value;
                    const period = this.getAttribute('data-period');
                    fetchStockData(symbol, period);
                });
            });

            // Enter key in stock search
            document.getElementById('stockSymbol').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('fetchStockData').click();
                }
            });
        }

        // Refresh data
        function refreshData(button, source) {
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
            button.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Update user data with small random changes
                userData.portfolioValue += (Math.random() - 0.5) * 1000;
                userData.totalReturns += (Math.random() - 0.5) * 500;
                
                // Update UI
                updateDashboardStats();
                updateNiftyValue();
                
                // Show toast
                showToast(`${source} data refreshed successfully!`);
                
                // Restore button
                button.innerHTML = originalText;
                button.disabled = false;
            }, 1500);
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('updateToast');
            const toastContent = toast.querySelector('.toast-content span');
            
            toastContent.textContent = message;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        // Add rotating animation
        const style = document.createElement('style');
        style.textContent = `
            .fa-spin {
                animation: fa-spin 1s linear infinite;
            }
            @keyframes fa-spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
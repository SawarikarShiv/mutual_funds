<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports & Analytics Dashboard</title>
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #3b82f6;
            --primary-light: #dbeafe;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #06b6d4;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --border: #e5e7eb;
            --sidebar: #1e293b;
            --sidebar-light: #334155;
        }

        body {
            background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 100%);
            background-size: cover;
            background-attachment: fixed;
            color: var(--dark);
            min-height: 100vh;
        }

        .container {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: rgba(30, 41, 59, 0.95);
            color: white;
            padding: 25px 0;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .logo {
            padding: 0 25px 30px;
            border-bottom: 1px solid var(--sidebar-light);
            margin-bottom: 25px;
        }

        .logo h2 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
        }

        .nav-menu {
            padding: 0 20px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            margin-bottom: 5px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #cbd5e1;
            text-decoration: none;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(51, 65, 85, 0.8);
            color: white;
        }

        .nav-item.active {
            background: var(--primary);
        }

        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .nav-section {
            margin: 30px 0 15px;
            padding: 0 25px;
            color: #94a3b8;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Main Content */
        .main-content {
            padding: 25px;
            overflow-y: auto;
            max-height: 100vh;
        }

        /* Page Content */
        .page-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page-content.active {
            display: block;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .header h1 {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--primary) 0%, #2563eb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        }

        .btn-outline {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary-light);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-success:hover {
            background: #0da271;
        }

        /* Settings Page Styles */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .settings-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .settings-header h3 {
            font-size: 1.3rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .setting-info h4 {
            font-size: 1rem;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .setting-info p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--secondary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .select-input {
            padding: 8px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            background: white;
            min-width: 150px;
        }

        /* Scheduled Reports Page Styles */
        .scheduled-reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .scheduled-report-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease;
        }

        .scheduled-report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .scheduled-report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .report-frequency {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }

        .frequency-daily { background: #dbeafe; color: var(--primary); }
        .frequency-weekly { background: #f3e8ff; color: #8b5cf6; }
        .frequency-monthly { background: #dcfce7; color: var(--secondary); }
        .frequency-quarterly { background: #ffedd5; color: #f97316; }

        .scheduled-report-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .scheduled-report-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-label {
            font-size: 0.85rem;
            color: var(--gray);
            font-weight: 500;
        }

        .detail-value {
            font-weight: 600;
            color: var(--dark);
        }

        .recipients-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .recipient-tag {
            background: var(--primary-light);
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .report-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .btn-icon {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--gray);
            transition: color 0.3s ease;
            padding: 8px;
            border-radius: 8px;
        }

        .btn-icon:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .btn-edit:hover { color: var(--primary); }
        .btn-delete:hover { color: var(--danger); }
        .btn-run:hover { color: var(--secondary); }

        /* Filter Bar */
        .filter-bar {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 180px;
        }

        .filter-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark);
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            background: white;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }

        .kpi-card.revenue { border-left-color: var(--secondary); }
        .kpi-card.users { border-left-color: var(--info); }
        .kpi-card.conversion { border-left-color: var(--warning); }
        .kpi-card.growth { border-left-color: var(--danger); }

        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .kpi-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .kpi-revenue .kpi-icon { background: #d1fae5; color: var(--secondary); }
        .kpi-users .kpi-icon { background: #cffafe; color: var(--info); }
        .kpi-conversion .kpi-icon { background: #fef3c7; color: var(--warning); }
        .kpi-growth .kpi-icon { background: #fee2e2; color: var(--danger); }

        .kpi-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.5);
        }

        .trend-up { color: var(--secondary); }
        .trend-down { color: var(--danger); }

        .kpi-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .kpi-label {
            color: var(--gray);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        /* KPI Details */
        .kpi-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: none;
        }

        .kpi-card.expanded .kpi-details {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .detail-value {
            font-weight: 600;
            color: var(--dark);
        }

        .detail-change {
            font-size: 0.85rem;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .detail-change.positive {
            background: #d1fae5;
            color: var(--secondary);
        }

        .detail-change.negative {
            background: #fee2e2;
            color: var(--danger);
        }

        /* Expand/Collapse Arrow */
        .expand-arrow {
            position: absolute;
            right: 25px;
            bottom: 25px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .kpi-card.expanded .expand-arrow {
            transform: rotate(180deg);
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .chart-header h3 {
            font-size: 1.3rem;
            color: var(--dark);
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Tables */
        .tables-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1200px) {
            .tables-grid {
                grid-template-columns: 1fr;
            }
        }

        .table-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .table-header h3 {
            font-size: 1.3rem;
            color: var(--dark);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: rgba(219, 234, 254, 0.7);
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            color: var(--gray);
        }

        tr:hover {
            background: rgba(249, 250, 251, 0.7);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-active { background: #d1fae5; color: var(--secondary); }
        .status-pending { background: #fef3c7; color: var(--warning); }
        .status-inactive { background: #fee2e2; color: var(--danger); }

        /* Report List */
        .reports-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .report-item {
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.5);
        }

        .report-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            background: white;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .report-type {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .type-financial { background: #dbeafe; color: var(--primary); }
        .type-sales { background: #dcfce7; color: var(--secondary); }
        .type-analytics { background: #f3e8ff; color: #8b5cf6; }
        .type-operational { background: #ffedd5; color: #f97316; }

        .report-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .report-meta {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 15px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .modal-header h2 {
            color: var(--dark);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .charts-grid, .tables-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .scheduled-report-details {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .kpi-card, .chart-card, .table-card, .settings-card, .scheduled-report-card {
            animation: fadeIn 0.5s ease;
        }

        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: var(--gray);
        }

        .loading::after {
            content: '';
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2>
                    <i class="fas fa-chart-line"></i>
                    <span>Analytics Pro</span>
                </h2>
            </div>
            
            <div class="nav-section">Main</div>
            <a href="#" class="nav-item active" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="reports">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </a>
            <a href="#" class="nav-item" data-page="analytics">
                <i class="fas fa-chart-pie"></i>
                <span>Analytics</span>
            </a>
            
            <div class="nav-section">Reports</div>
            <a href="#" class="nav-item" data-page="financial">
                <i class="fas fa-money-bill-wave"></i>
                <span>Financial</span>
            </a>
            <a href="#" class="nav-item" data-page="sales">
                <i class="fas fa-shopping-cart"></i>
                <span>Sales</span>
            </a>
            <a href="#" class="nav-item" data-page="user-analytics">
                <i class="fas fa-users"></i>
                <span>User Analytics</span>
            </a>
            <a href="#" class="nav-item" data-page="operations">
                <i class="fas fa-cogs"></i>
                <span>Operations</span>
            </a>
            
            <div class="nav-section">Settings</div>
            <a href="#" class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
            <a href="#" class="nav-item" data-page="scheduled-reports">
                <i class="fas fa-calendar-alt"></i>
                <span>Scheduled Reports</span>
            </a>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page (Default) -->
            <div class="page-content active" id="dashboard-page">
                <!-- Header -->
                <div class="header">
                    <h1>
                        <i class="fas fa-chart-line"></i>
                        Reports & Analytics Dashboard
                    </h1>
                    <div class="header-actions">
                        <div class="date-range">
                            <input type="date" class="date-input" id="startDate" value="2024-01-01">
                            <span>to</span>
                            <input type="date" class="date-input" id="endDate" value="2024-12-31">
                        </div>
                        <button class="btn btn-outline" onclick="refreshData()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                        <button class="btn btn-primary" onclick="openExportModal()">
                            <i class="fas fa-file-export"></i>
                            Export Report
                        </button>
                    </div>
                </div>

                <!-- Filter Bar -->
                <div class="filter-bar">
                    <div class="filter-group">
                        <label class="filter-label">Report Type</label>
                        <select class="filter-select" id="reportType">
                            <option value="all">All Reports</option>
                            <option value="financial">Financial</option>
                            <option value="sales">Sales</option>
                            <option value="user">User Analytics</option>
                            <option value="operations">Operations</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Time Period</label>
                        <div class="time-period">
                            <button class="period-btn active" onclick="setPeriod('day')">Day</button>
                            <button class="period-btn" onclick="setPeriod('week')">Week</button>
                            <button class="period-btn" onclick="setPeriod('month')">Month</button>
                            <button class="period-btn" onclick="setPeriod('year')">Year</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Department</label>
                        <select class="filter-select" id="department">
                            <option value="all">All Departments</option>
                            <option value="sales">Sales</option>
                            <option value="marketing">Marketing</option>
                            <option value="finance">Finance</option>
                            <option value="operations">Operations</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Metrics</label>
                        <select class="filter-select" id="metrics">
                            <option value="overview">Overview</option>
                            <option value="revenue">Revenue</option>
                            <option value="users">User Growth</option>
                            <option value="conversion">Conversion</option>
                            <option value="performance">Performance</option>
                        </select>
                    </div>
                </div>

                <!-- KPI Cards -->
                <div class="kpi-grid">
                    <!-- Revenue Card -->
                    <div class="kpi-card kpi-revenue revenue" onclick="toggleKPIDetails('revenue')">
                        <div class="kpi-header">
                            <div class="kpi-icon"><i class="fas fa-money-bill-wave"></i></div>
                            <div class="kpi-trend trend-up">
                                <span>↑</span>
                                <span>12.5%</span>
                            </div>
                        </div>
                        <div class="kpi-value">$124,580</div>
                        <div class="kpi-label">Total Revenue</div>
                        
                        <!-- Detailed Breakdown -->
                        <div class="kpi-details" id="revenue-details">
                            <div class="detail-row">
                                <span class="detail-label">Product Sales</span>
                                <span class="detail-value">$68,450</span>
                                <span class="detail-change positive">+8.2%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Services</span>
                                <span class="detail-value">$32,120</span>
                                <span class="detail-change positive">+15.3%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Subscriptions</span>
                                <span class="detail-value">$18,450</span>
                                <span class="detail-change positive">+5.7%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Other Income</span>
                                <span class="detail-value">$5,560</span>
                                <span class="detail-change negative">-2.1%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Avg. Transaction</span>
                                <span class="detail-value">$245.80</span>
                                <span class="detail-change positive">+3.4%</span>
                            </div>
                        </div>
                        
                        <div class="expand-arrow"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    
                    <!-- Users Card -->
                    <div class="kpi-card kpi-users users" onclick="toggleKPIDetails('users')">
                        <div class="kpi-header">
                            <div class="kpi-icon"><i class="fas fa-users"></i></div>
                            <div class="kpi-trend trend-up">
                                <span>↑</span>
                                <span>8.2%</span>
                            </div>
                        </div>
                        <div class="kpi-value">3,245</div>
                        <div class="kpi-label">Active Users</div>
                        
                        <!-- Detailed Breakdown -->
                        <div class="kpi-details" id="users-details">
                            <div class="detail-row">
                                <span class="detail-label">New Users</span>
                                <span class="detail-value">324</span>
                                <span class="detail-change positive">+12.4%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Returning Users</span>
                                <span class="detail-value">1,845</span>
                                <span class="detail-change positive">+5.2%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Churned Users</span>
                                <span class="detail-value">47</span>
                                <span class="detail-change negative">-1.8%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Avg. Session</span>
                                <span class="detail-value">4m 32s</span>
                                <span class="detail-change positive">+15s</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Retention Rate</span>
                                <span class="detail-value">85.2%</span>
                                <span class="detail-change positive">+2.1%</span>
                            </div>
                        </div>
                        
                        <div class="expand-arrow"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    
                    <!-- Conversion Card -->
                    <div class="kpi-card kpi-conversion conversion" onclick="toggleKPIDetails('conversion')">
                        <div class="kpi-header">
                            <div class="kpi-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="kpi-trend trend-down">
                                <span>↓</span>
                                <span>2.1%</span>
                            </div>
                        </div>
                        <div class="kpi-value">24.3%</div>
                        <div class="kpi-label">Conversion Rate</div>
                        
                        <!-- Detailed Breakdown -->
                        <div class="kpi-details" id="conversion-details">
                            <div class="detail-row">
                                <span class="detail-label">Website</span>
                                <span class="detail-value">3.2%</span>
                                <span class="detail-change positive">+0.4%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Mobile App</span>
                                <span class="detail-value">8.5%</span>
                                <span class="detail-change negative">-1.2%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Email Campaign</span>
                                <span class="detail-value">12.4%</span>
                                <span class="detail-change positive">+2.1%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Social Media</span>
                                <span class="detail-value">5.3%</span>
                                <span class="detail-change negative">-3.4%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Direct Traffic</span>
                                <span class="detail-value">15.8%</span>
                                <span class="detail-change positive">+1.5%</span>
                            </div>
                        </div>
                        
                        <div class="expand-arrow"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    
                    <!-- Growth Card -->
                    <div class="kpi-card kpi-growth growth" onclick="toggleKPIDetails('growth')">
                        <div class="kpi-header">
                            <div class="kpi-icon"><i class="fas fa-chart-bar"></i></div>
                            <div class="kpi-trend trend-up">
                                <span>↑</span>
                                <span>15.7%</span>
                            </div>
                        </div>
                        <div class="kpi-value">45.2%</div>
                        <div class="kpi-label">Growth Rate</div>
                        
                        <!-- Detailed Breakdown -->
                        <div class="kpi-details" id="growth-details">
                            <div class="detail-row">
                                <span class="detail-label">Monthly Growth</span>
                                <span class="detail-value">12.4%</span>
                                <span class="detail-change positive">+1.2%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Quarterly Growth</span>
                                <span class="detail-value">28.7%</span>
                                <span class="detail-change positive">+3.5%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Year-over-Year</span>
                                <span class="detail-value">67.3%</span>
                                <span class="detail-change positive">+8.9%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Market Share</span>
                                <span class="detail-value">18.5%</span>
                                <span class="detail-change positive">+2.3%</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Revenue Growth</span>
                                <span class="detail-value">32.8%</span>
                                <span class="detail-change positive">+4.1%</span>
                            </div>
                        </div>
                        
                        <div class="expand-arrow"><i class="fas fa-chevron-down"></i></div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Revenue Trend</h3>
                            <select class="filter-select" style="width: auto;">
                                <option>Monthly</option>
                                <option>Quarterly</option>
                                <option>Yearly</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>User Acquisition</h3>
                            <select class="filter-select" style="width: auto;">
                                <option>By Channel</option>
                                <option>By Region</option>
                                <option>By Device</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="userChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page-content" id="settings-page">
                <!-- Header -->
                <div class="header">
                    <h1>
                        <i class="fas fa-cog"></i>
                        Settings & Configuration
                    </h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="saveSettings()">
                            <i class="fas fa-save"></i>
                            Save Changes
                        </button>
                        <button class="btn btn-outline" onclick="resetSettings()">
                            <i class="fas fa-undo"></i>
                            Reset to Default
                        </button>
                    </div>
                </div>

                <!-- Settings Grid -->
                <div class="settings-grid">
                    <!-- General Settings -->
                    <div class="settings-card">
                        <div class="settings-header">
                            <h3><i class="fas fa-sliders-h"></i> General Settings</h3>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Auto-refresh Dashboard</h4>
                                <p>Automatically refresh dashboard data</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoRefresh" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Email Notifications</h4>
                                <p>Receive email alerts for reports</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="emailNotifications" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Data Retention Period</h4>
                                <p>How long to keep report data</p>
                            </div>
                            <select class="select-input" id="dataRetention">
                                <option value="30">30 days</option>
                                <option value="90" selected>90 days</option>
                                <option value="180">180 days</option>
                                <option value="365">1 year</option>
                                <option value="730">2 years</option>
                            </select>
                        </div>
                    </div>

                    <!-- Export Settings -->
                    <div class="settings-card">
                        <div class="settings-header">
                            <h3><i class="fas fa-file-export"></i> Export Settings</h3>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Default Export Format</h4>
                                <p>Preferred format for report exports</p>
                            </div>
                            <select class="select-input" id="defaultExportFormat">
                                <option value="pdf">PDF</option>
                                <option value="excel" selected>Excel</option>
                                <option value="csv">CSV</option>
                                <option value="json">JSON</option>
                            </select>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Include Charts in Export</h4>
                                <p>Export charts as images in reports</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="includeCharts" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Compress Exported Files</h4>
                                <p>Create ZIP files for large exports</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="compressFiles">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Data Source Settings -->
                    <div class="settings-card">
                        <div class="settings-header">
                            <h3><i class="fas fa-database"></i> Data Sources</h3>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Sales Database</h4>
                                <p>PostgreSQL - sales_data</p>
                            </div>
                            <span class="status-badge status-active">Connected</span>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Analytics API</h4>
                                <p>Google Analytics API v4</p>
                            </div>
                            <span class="status-badge status-active">Connected</span>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>CRM System</h4>
                                <p>Salesforce API Integration</p>
                            </div>
                            <span class="status-badge status-pending">Syncing</span>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Cache Duration</h4>
                                <p>How long to cache dashboard data</p>
                            </div>
                            <select class="select-input" id="cacheDuration">
                                <option value="5">5 minutes</option>
                                <option value="15" selected>15 minutes</option>
                                <option value="30">30 minutes</option>
                                <option value="60">1 hour</option>
                            </select>
                        </div>
                    </div>

                    <!-- User Preferences -->
                    <div class="settings-card">
                        <div class="settings-header">
                            <h3><i class="fas fa-user-cog"></i> User Preferences</h3>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Dashboard Theme</h4>
                                <p>Choose your preferred theme</p>
                            </div>
                            <select class="select-input" id="dashboardTheme">
                                <option value="light">Light Mode</option>
                                <option value="dark">Dark Mode</option>
                                <option value="auto" selected>Auto (System)</option>
                            </select>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Default Date Range</h4>
                                <p>Default period for reports</p>
                            </div>
                            <select class="select-input" id="defaultDateRange">
                                <option value="today">Today</option>
                                <option value="yesterday">Yesterday</option>
                                <option value="week">This Week</option>
                                <option value="month" selected>This Month</option>
                                <option value="quarter">This Quarter</option>
                                <option value="year">This Year</option>
                            </select>
                        </div>
                        <div class="settings-item">
                            <div class="setting-info">
                                <h4>Results Per Page</h4>
                                <p>Number of items per page in tables</p>
                            </div>
                            <select class="select-input" id="resultsPerPage">
                                <option value="10">10</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scheduled Reports Page -->
            <div class="page-content" id="scheduled-reports-page">
                <!-- Header -->
                <div class="header">
                    <h1>
                        <i class="fas fa-calendar-alt"></i>
                        Scheduled Reports
                    </h1>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="openNewScheduleModal()">
                            <i class="fas fa-plus"></i>
                            New Schedule
                        </button>
                        <button class="btn btn-outline" onclick="refreshScheduledReports()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>

                <!-- Scheduled Reports Grid -->
                <div class="scheduled-reports-grid" id="scheduledReportsContainer">
                    <!-- Reports will be loaded here dynamically -->
                </div>

                <!-- Recent Executions -->
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-history"></i> Recent Executions</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Report Name</th>
                                    <th>Scheduled Time</th>
                                    <th>Actual Time</th>
                                    <th>Status</th>
                                    <th>Recipients</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recentExecutions">
                                <!-- Executions will be loaded here dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Schedule Modal -->
    <div class="modal" id="newScheduleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Schedule New Report</h2>
                <button class="close-modal" onclick="closeNewScheduleModal()">×</button>
            </div>
            <form id="scheduleForm" onsubmit="saveNewSchedule(event)">
                <div class="form-group">
                    <label class="form-label">Report Name</label>
                    <input type="text" class="form-input" id="scheduleName" placeholder="Monthly Sales Report" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Report Type</label>
                    <select class="form-input" id="scheduleReportType" required>
                        <option value="">Select Report Type</option>
                        <option value="financial">Financial Report</option>
                        <option value="sales">Sales Report</option>
                        <option value="user">User Analytics</option>
                        <option value="operations">Operations Report</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Frequency</label>
                    <select class="form-input" id="scheduleFrequency" required>
                        <option value="daily">Daily</option>
                        <option value="weekly" selected>Weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="yearly">Yearly</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Schedule Time</label>
                    <input type="time" class="form-input" id="scheduleTime" value="09:00" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Recipients (comma-separated emails)</label>
                    <input type="text" class="form-input" id="scheduleRecipients" 
                           placeholder="admin@company.com, manager@company.com" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Format</label>
                    <select class="form-input" id="scheduleFormat">
                        <option value="pdf">PDF</option>
                        <option value="excel" selected>Excel</option>
                        <option value="both">PDF & Excel</option>
                    </select>
                </div>
                
                <div class="btn-group" style="margin-top: 30px; display: flex; gap: 15px;">
                    <button type="submit" class="btn btn-primary">Save Schedule</button>
                    <button type="button" class="btn btn-secondary" onclick="closeNewScheduleModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Page Navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize charts
            initializeCharts();
            
            // Setup navigation
            setupNavigation();
            
            // Load scheduled reports
            loadScheduledReports();
            
            // Load recent executions
            loadRecentExecutions();
            
            // Setup KPI click handlers
            setupKPIClickHandlers();
        });

        // Navigation Setup
        function setupNavigation() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all nav items
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Get page name
                    const pageName = this.getAttribute('data-page');
                    
                    // Hide all pages
                    document.querySelectorAll('.page-content').forEach(page => {
                        page.classList.remove('active');
                    });
                    
                    // Show selected page
                    const pageElement = document.getElementById(`${pageName}-page`);
                    if (pageElement) {
                        pageElement.classList.add('active');
                    } else {
                        // Default to dashboard if page not found
                        document.getElementById('dashboard-page').classList.add('active');
                    }
                });
            });
        }

        // Scheduled Reports Data
        const scheduledReportsData = [
            {
                id: 1,
                name: "Daily Sales Summary",
                type: "Sales Report",
                frequency: "daily",
                nextRun: "Tomorrow, 08:00 AM",
                lastRun: "Today, 08:00 AM",
                recipients: ["sales@company.com", "manager@company.com", "ceo@company.com"],
                format: "PDF",
                status: "active"
            },
            {
                id: 2,
                name: "Weekly Financial Report",
                type: "Financial Report",
                frequency: "weekly",
                nextRun: "Monday, 09:00 AM",
                lastRun: "Last Monday, 09:00 AM",
                recipients: ["finance@company.com", "director@company.com"],
                format: "Excel",
                status: "active"
            },
            {
                id: 3,
                name: "Monthly User Analytics",
                type: "User Analytics",
                frequency: "monthly",
                nextRun: "1st of next month, 10:00 AM",
                lastRun: "December 1, 10:00 AM",
                recipients: ["analytics@company.com", "product@company.com"],
                format: "PDF & Excel",
                status: "active"
            },
            {
                id: 4,
                name: "Quarterly Operations Review",
                type: "Operations Report",
                frequency: "quarterly",
                nextRun: "April 1, 11:00 AM",
                lastRun: "January 1, 11:00 AM",
                recipients: ["ops@company.com", "coo@company.com"],
                format: "PDF",
                status: "pending"
            },
            {
                id: 5,
                name: "Annual Performance Review",
                type: "Financial Report",
                frequency: "yearly",
                nextRun: "January 15, 2025, 09:00 AM",
                lastRun: "January 15, 2024, 09:00 AM",
                recipients: ["board@company.com", "all_managers@company.com"],
                format: "PDF & Excel",
                status: "active"
            },
            {
                id: 6,
                name: "Weekly Marketing Metrics",
                type: "Analytics Report",
                frequency: "weekly",
                nextRun: "Friday, 03:00 PM",
                lastRun: "Last Friday, 03:00 PM",
                recipients: ["marketing@company.com"],
                format: "Excel",
                status: "inactive"
            }
        ];

        // Recent Executions Data
        const recentExecutionsData = [
            {
                reportName: "Daily Sales Summary",
                scheduledTime: "Today, 08:00 AM",
                actualTime: "Today, 08:01 AM",
                status: "success",
                recipients: 3,
                fileSize: "2.4 MB"
            },
            {
                reportName: "Weekly Financial Report",
                scheduledTime: "Last Monday, 09:00 AM",
                actualTime: "Last Monday, 09:00 AM",
                status: "success",
                recipients: 2,
                fileSize: "5.1 MB"
            },
            {
                reportName: "Monthly User Analytics",
                scheduledTime: "December 1, 10:00 AM",
                actualTime: "December 1, 10:05 AM",
                status: "success",
                recipients: 2,
                fileSize: "3.8 MB"
            },
            {
                reportName: "Weekly Marketing Metrics",
                scheduledTime: "Last Friday, 03:00 PM",
                actualTime: "Last Friday, 03:15 PM",
                status: "delayed",
                recipients: 1,
                fileSize: "1.2 MB"
            },
            {
                reportName: "Daily Operations Check",
                scheduledTime: "Yesterday, 11:00 AM",
                actualTime: "N/A",
                status: "failed",
                recipients: 0,
                fileSize: "N/A"
            }
        ];

        // Load Scheduled Reports
        function loadScheduledReports() {
            const container = document.getElementById('scheduledReportsContainer');
            container.innerHTML = '';
            
            scheduledReportsData.forEach(report => {
                const frequencyClass = `frequency-${report.frequency}`;
                const statusClass = `status-${report.status}`;
                
                const reportCard = document.createElement('div');
                reportCard.className = 'scheduled-report-card';
                reportCard.innerHTML = `
                    <div class="scheduled-report-header">
                        <span class="report-frequency ${frequencyClass}">
                            ${report.frequency.charAt(0).toUpperCase() + report.frequency.slice(1)}
                        </span>
                        <span class="status-badge ${statusClass}">
                            ${report.status.charAt(0).toUpperCase() + report.status.slice(1)}
                        </span>
                    </div>
                    <h3 class="scheduled-report-title">${report.name}</h3>
                    <p style="color: var(--gray); margin-bottom: 15px;">${report.type}</p>
                    
                    <div class="scheduled-report-details">
                        <div class="detail-item">
                            <span class="detail-label">Next Run</span>
                            <span class="detail-value">${report.nextRun}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Last Run</span>
                            <span class="detail-value">${report.lastRun}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Format</span>
                            <span class="detail-value">${report.format}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Status</span>
                            <span class="detail-value">
                                <span class="status-badge ${statusClass}" style="font-size: 0.8rem;">
                                    ${report.status.charAt(0).toUpperCase() + report.status.slice(1)}
                                </span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">Recipients</span>
                        <div class="recipients-list">
                            ${report.recipients.map(email => 
                                `<span class="recipient-tag">
                                    <i class="fas fa-envelope"></i>
                                    ${email}
                                </span>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div class="report-actions">
                        <button class="btn-icon btn-run" onclick="runScheduleNow(${report.id})" 
                                ${report.status === 'inactive' ? 'disabled' : ''}>
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="btn-icon btn-edit" onclick="editSchedule(${report.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon btn-delete" onclick="deleteSchedule(${report.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                container.appendChild(reportCard);
            });
        }

        // Load Recent Executions
        function loadRecentExecutions() {
            const container = document.getElementById('recentExecutions');
            container.innerHTML = '';
            
            recentExecutionsData.forEach(execution => {
                let statusBadge = '';
                switch(execution.status) {
                    case 'success':
                        statusBadge = '<span class="status-badge status-active">Success</span>';
                        break;
                    case 'delayed':
                        statusBadge = '<span class="status-badge status-pending">Delayed</span>';
                        break;
                    case 'failed':
                        statusBadge = '<span class="status-badge status-inactive">Failed</span>';
                        break;
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${execution.reportName}</td>
                    <td>${execution.scheduledTime}</td>
                    <td>${execution.actualTime}</td>
                    <td>${statusBadge}</td>
                    <td>${execution.recipients} recipient${execution.recipients !== 1 ? 's' : ''}</td>
                    <td>
                        <button class="btn-icon" onclick="viewExecutionDetails('${execution.reportName}')" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-icon" onclick="resendReport('${execution.reportName}')" title="Resend Report">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </td>
                `;
                
                container.appendChild(row);
            });
        }

        // Modal Functions
        function openNewScheduleModal() {
            document.getElementById('newScheduleModal').classList.add('active');
        }

        function closeNewScheduleModal() {
            document.getElementById('newScheduleModal').classList.remove('active');
            document.getElementById('scheduleForm').reset();
        }

        function saveNewSchedule(event) {
            event.preventDefault();
            
            const newSchedule = {
                id: scheduledReportsData.length + 1,
                name: document.getElementById('scheduleName').value,
                type: document.getElementById('scheduleReportType').value,
                frequency: document.getElementById('scheduleFrequency').value,
                nextRun: getNextRunTime(document.getElementById('scheduleFrequency').value, 
                                      document.getElementById('scheduleTime').value),
                lastRun: "Never",
                recipients: document.getElementById('scheduleRecipients').value.split(',').map(email => email.trim()),
                format: document.getElementById('scheduleFormat').value,
                status: "active"
            };
            
            scheduledReportsData.unshift(newSchedule);
            loadScheduledReports();
            
            showNotification('New schedule created successfully!', 'success');
            closeNewScheduleModal();
        }

        function getNextRunTime(frequency, time) {
            const now = new Date();
            const [hours, minutes] = time.split(':').map(Number);
            
            let nextRun = new Date();
            nextRun.setHours(hours, minutes, 0, 0);
            
            switch(frequency) {
                case 'daily':
                    if (nextRun <= now) {
                        nextRun.setDate(nextRun.getDate() + 1);
                    }
                    return `Tomorrow, ${formatTime(nextRun)}`;
                    
                case 'weekly':
                    // Next Monday
                    const daysUntilMonday = (8 - now.getDay()) % 7 || 7;
                    nextRun.setDate(now.getDate() + daysUntilMonday);
                    return `Monday, ${formatDate(nextRun)} at ${formatTime(nextRun)}`;
                    
                case 'monthly':
                    // 1st of next month
                    nextRun = new Date(now.getFullYear(), now.getMonth() + 1, 1, hours, minutes);
                    return `1st of next month, ${formatTime(nextRun)}`;
                    
                case 'quarterly':
                    // Next quarter
                    const currentQuarter = Math.floor(now.getMonth() / 3);
                    const nextQuarterMonth = (currentQuarter + 1) * 3;
                    nextRun = new Date(now.getFullYear(), nextQuarterMonth, 1, hours, minutes);
                    return `${getMonthName(nextQuarterMonth)} 1, ${formatTime(nextRun)}`;
                    
                case 'yearly':
                    nextRun = new Date(now.getFullYear() + 1, 0, 1, hours, minutes);
                    return `January 1, ${nextRun.getFullYear()}, ${formatTime(nextRun)}`;
            }
            
            return "Soon";
        }

        function formatTime(date) {
            let hours = date.getHours();
            const minutes = date.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;
            return `${hours}:${minutes} ${ampm}`;
        }

        function formatDate(date) {
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const month = months[date.getMonth()];
            const day = date.getDate();
            return `${month} ${day}`;
        }

        function getMonthName(monthIndex) {
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                          'July', 'August', 'September', 'October', 'November', 'December'];
            return months[monthIndex];
        }

        // Schedule Actions
        function runScheduleNow(scheduleId) {
            const schedule = scheduledReportsData.find(r => r.id === scheduleId);
            if (schedule) {
                showNotification(`Running "${schedule.name}" now...`, 'info');
                // Simulate report generation
                setTimeout(() => {
                    showNotification(`Report "${schedule.name}" generated and sent to ${schedule.recipients.length} recipients`, 'success');
                }, 2000);
            }
        }

        function editSchedule(scheduleId) {
            const schedule = scheduledReportsData.find(r => r.id === scheduleId);
            if (schedule) {
                document.getElementById('scheduleName').value = schedule.name;
                document.getElementById('scheduleReportType').value = schedule.type.toLowerCase();
                document.getElementById('scheduleFrequency').value = schedule.frequency;
                document.getElementById('scheduleRecipients').value = schedule.recipients.join(', ');
                document.getElementById('scheduleFormat').value = schedule.format.toLowerCase();
                
                showNotification(`Editing "${schedule.name}"`, 'info');
                openNewScheduleModal();
            }
        }

        function deleteSchedule(scheduleId) {
            if (confirm('Are you sure you want to delete this schedule?')) {
                const index = scheduledReportsData.findIndex(r => r.id === scheduleId);
                if (index !== -1) {
                    const scheduleName = scheduledReportsData[index].name;
                    scheduledReportsData.splice(index, 1);
                    loadScheduledReports();
                    showNotification(`Schedule "${scheduleName}" deleted`, 'success');
                }
            }
        }

        function refreshScheduledReports() {
            showLoading();
            setTimeout(() => {
                loadScheduledReports();
                loadRecentExecutions();
                hideLoading();
                showNotification('Scheduled reports refreshed', 'success');
            }, 1000);
        }

        function viewExecutionDetails(reportName) {
            showNotification(`Viewing details for "${reportName}"`, 'info');
            // In a real app, this would open a detailed view
        }

        function resendReport(reportName) {
            if (confirm(`Resend "${reportName}" to all recipients?`)) {
                showNotification(`Resending "${reportName}"...`, 'info');
                setTimeout(() => {
                    showNotification(`"${reportName}" resent successfully`, 'success');
                }, 1500);
            }
        }

        // Settings Functions
        function saveSettings() {
            // Collect all settings
            const settings = {
                autoRefresh: document.getElementById('autoRefresh').checked,
                emailNotifications: document.getElementById('emailNotifications').checked,
                dataRetention: document.getElementById('dataRetention').value,
                defaultExportFormat: document.getElementById('defaultExportFormat').value,
                includeCharts: document.getElementById('includeCharts').checked,
                compressFiles: document.getElementById('compressFiles').checked,
                cacheDuration: document.getElementById('cacheDuration').value,
                dashboardTheme: document.getElementById('dashboardTheme').value,
                defaultDateRange: document.getElementById('defaultDateRange').value,
                resultsPerPage: document.getElementById('resultsPerPage').value
            };
            
            // Save to localStorage (in real app, save to backend)
            localStorage.setItem('dashboardSettings', JSON.stringify(settings));
            
            showNotification('Settings saved successfully!', 'success');
        }

        function resetSettings() {
            if (confirm('Reset all settings to default values?')) {
                // Reset all toggles and selects to default
                document.getElementById('autoRefresh').checked = true;
                document.getElementById('emailNotifications').checked = true;
                document.getElementById('dataRetention').value = '90';
                document.getElementById('defaultExportFormat').value = 'excel';
                document.getElementById('includeCharts').checked = true;
                document.getElementById('compressFiles').checked = false;
                document.getElementById('cacheDuration').value = '15';
                document.getElementById('dashboardTheme').value = 'auto';
                document.getElementById('defaultDateRange').value = 'month';
                document.getElementById('resultsPerPage').value = '25';
                
                localStorage.removeItem('dashboardSettings');
                showNotification('Settings reset to default values', 'success');
            }
        }

        // Dashboard Functions (from previous implementation)
        function setupKPIClickHandlers() {
            document.querySelectorAll('.kpi-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    if (!e.target.closest('.expand-arrow')) {
                        toggleKPIDetails(this.classList[1].replace('kpi-', ''));
                    }
                });
            });
        }

        function toggleKPIDetails(kpiType) {
            const card = document.querySelector(`.kpi-${kpiType}`);
            const arrow = card.querySelector('.expand-arrow i');
            
            card.classList.toggle('expanded');
            arrow.style.transform = card.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0deg)';
        }

        function initializeCharts() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Revenue',
                        data: [65000, 72000, 81000, 89000, 95000, 102000, 112000, 105000, 115000, 120000, 125000, 124580],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });

            // User Acquisition Chart
            const userCtx = document.getElementById('userChart').getContext('2d');
            new Chart(userCtx, {
                type: 'bar',
                data: {
                    labels: ['Organic', 'Paid Ads', 'Social Media', 'Email', 'Referral', 'Direct'],
                    datasets: [{
                        label: 'New Users',
                        data: [1200, 800, 450, 300, 250, 150],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)', 'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)', 'rgba(239, 68, 68, 0.8)',
                            'rgba(139, 92, 246, 0.8)', 'rgba(6, 182, 212, 0.8)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });
        }

        // Utility Functions
        function showLoading() {
            const overlay = document.createElement('div');
            overlay.id = 'loadingOverlay';
            overlay.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(255, 255, 255, 0.9); display: flex;
                justify-content: center; align-items: center; z-index: 9999;
            `;
            overlay.innerHTML = '<div class="loading"></div>';
            document.body.appendChild(overlay);
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) overlay.remove();
        }

        function showNotification(message, type) {
            // Remove existing notification
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; padding: 15px 25px;
                border-radius: 10px; color: white; font-weight: 600; z-index: 9999;
                animation: fadeIn 0.3s ease;
                background: ${type === 'success' ? 'var(--secondary)' : 
                           type === 'error' ? 'var(--danger)' : 'var(--info)'};
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => notification.remove(), 3000);
        }

        // Export functions (simplified)
        function openExportModal() {
            showNotification('Export feature would open here', 'info');
        }

        function refreshData() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showNotification('Dashboard data refreshed', 'success');
            }, 1000);
        }

        function setPeriod(period) {
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            showNotification(`Time period set to ${period}`, 'info');
        }
    </script>
</body>
</html>
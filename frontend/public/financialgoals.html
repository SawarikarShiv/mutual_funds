<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Goals | Infinity Mutual Funds</title>
    <meta name="description" content="Plan and track your financial goals with smart investment recommendations">
    <meta name="author" content="Infinity Financial Services">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/components.css">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            --info-gradient: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(rgba(10, 15, 46, 0.95), rgba(26, 31, 78, 0.95)), url('assets/images/dashboard/hero-bg.png');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .goals-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo-image {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            object-fit: contain;
        }
        
        .brand-name {
            color: white;
            font-size: 18px;
            font-weight: 600;
        }
        
        .user-profile {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 3px solid #667eea;
            object-fit: cover;
        }
        
        .user-name {
            color: white;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .user-email {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .user-plan {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #cbd5e1;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            color: white;
            border-left: 3px solid #667eea;
        }
        
        .nav-link i {
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logout-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #ef4444;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        
        /* Main Content Styles */
        .main-content {
            padding: 30px;
            overflow-y: auto;
        }
        
        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .welcome-message h1 {
            color: white;
            margin-bottom: 10px;
        }
        
        .welcome-message p {
            color: #cbd5e1;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 12px 25px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Goals Overview */
        .goals-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .overview-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        
        .overview-card:hover {
            transform: translateY(-5px);
        }
        
        .overview-card.primary {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
        }
        
        .overview-card.success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(5, 150, 105, 0.2) 100%);
        }
        
        .overview-card.warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(217, 119, 6, 0.2) 100%);
        }
        
        .overview-card.info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(29, 78, 216, 0.2) 100%);
        }
        
        .overview-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .overview-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .overview-value {
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .overview-label {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }
        
        .progress-fill.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .progress-fill.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .progress-fill.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .progress-fill.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            color: #cbd5e1;
            font-size: 0.85rem;
        }
        
        /* Goals Grid */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .goal-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .goal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .goal-card.priority-high {
            border-left: 4px solid #ef4444;
        }
        
        .goal-card.priority-medium {
            border-left: 4px solid #f59e0b;
        }
        
        .goal-card.priority-low {
            border-left: 4px solid #10b981;
        }
        
        .goal-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .goal-category {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .category-icon.retirement {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .category-icon.house {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .category-icon.education {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .category-icon.car {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .category-icon.vacation {
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
        }
        
        .category-icon.wedding {
            background: rgba(236, 72, 153, 0.2);
            color: #ec4899;
        }
        
        .category-icon.emergency {
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
        }
        
        .goal-title {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .goal-subtitle {
            color: #cbd5e1;
            font-size: 0.9rem;
        }
        
        .goal-priority {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .priority-high {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .priority-medium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .priority-low {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .goal-details {
            margin-bottom: 20px;
        }
        
        .goal-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .goal-metric {
            text-align: center;
        }
        
        .metric-value {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #cbd5e1;
            font-size: 0.85rem;
        }
        
        .goal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .action-btn {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .action-btn.primary {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
        }
        
        .action-btn.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .action-btn.warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        /* Goal Timeline */
        .timeline-section {
            margin-bottom: 30px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .section-header h2 {
            color: white;
        }
        
        .timeline-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .timeline-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .timeline-marker {
            position: absolute;
            left: -30px;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid;
        }
        
        .timeline-content {
            margin-left: 20px;
        }
        
        .timeline-date {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .timeline-title {
            color: white;
            margin-bottom: 10px;
        }
        
        .timeline-description {
            color: #cbd5e1;
            font-size: 0.9rem;
        }
        
        /* Recommendations */
        .recommendations-section {
            margin-bottom: 30px;
        }
        
        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .recommendation-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .recommendation-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .recommendation-title {
            color: white;
            font-size: 1.1rem;
        }
        
        .recommendation-content {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .recommendation-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Footer */
        .goals-footer {
            text-align: center;
            padding: 20px;
            color: #cbd5e1;
            font-size: 0.85rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .modal-header h2 {
            color: white;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: white;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #e2e8f0;
            font-size: 14px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            animation: slideIn 0.5s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            display: none;
        }
        
        .notification.show {
            display: flex;
        }
        
        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .goals-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                z-index: 1000;
                transition: left 0.3s ease;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-menu-toggle {
                display: block;
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: white;
                width: 50px;
                height: 50px;
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                cursor: pointer;
            }
            
            .goals-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .goals-overview {
                grid-template-columns: 1fr;
            }
            
            .goal-metrics {
                grid-template-columns: 1fr;
            }
            
            .main-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .goal-actions {
                flex-direction: column;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Goal Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .status-completed {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .status-delayed {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .status-pending {
            background: rgba(148, 163, 184, 0.2);
            color: #94a3b8;
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationMessage">Action completed successfully!</span>
    </div>
    
    <!-- Mobile Menu Toggle -->
    <div class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- Create Goal Modal -->
    <div class="modal" id="createGoalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Financial Goal</h2>
                <button class="close-modal" id="closeCreateGoalModal">&times;</button>
            </div>
            <form id="createGoalForm">
                <div class="form-group">
                    <label for="goalName">Goal Name</label>
                    <input type="text" id="goalName" placeholder="e.g., Retirement Fund, Children's Education" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="goalCategory">Category</label>
                        <select id="goalCategory" required>
                            <option value="">Select category</option>
                            <option value="retirement">Retirement</option>
                            <option value="house">House Purchase</option>
                            <option value="education">Education</option>
                            <option value="car">Car Purchase</option>
                            <option value="vacation">Vacation</option>
                            <option value="wedding">Wedding</option>
                            <option value="emergency">Emergency Fund</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="goalPriority">Priority</label>
                        <select id="goalPriority" required>
                            <option value="">Select priority</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="targetAmount">Target Amount (₹)</label>
                        <input type="number" id="targetAmount" placeholder="e.g., 5000000" min="1000" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeframe">Timeframe (Years)</label>
                        <input type="number" id="timeframe" placeholder="e.g., 10" min="1" max="50" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="currentSavings">Current Savings (₹)</label>
                        <input type="number" id="currentSavings" placeholder="e.g., 500000" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="monthlyContribution">Monthly Contribution (₹)</label>
                        <input type="number" id="monthlyContribution" placeholder="e.g., 15000" min="0">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="expectedReturn">Expected Annual Return (%)</label>
                    <input type="number" id="expectedReturn" placeholder="e.g., 12" min="1" max="30" step="0.1" required>
                </div>
                
                <div class="form-group">
                    <label for="goalDescription">Description (Optional)</label>
                    <textarea id="goalDescription" rows="3" placeholder="Add details about your goal..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCreateGoal">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitCreateGoal">
                        <span id="submitCreateGoalText">Create Goal</span>
                        <span id="submitCreateGoalLoading" class="loading" style="display: none;"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Goal Details Modal -->
    <div class="modal" id="goalDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="detailsGoalTitle">Goal Details</h2>
                <button class="close-modal" id="closeGoalDetailsModal">&times;</button>
            </div>
            
            <div class="goal-details-content" id="goalDetailsContent">
                <!-- Goal details will be loaded here -->
            </div>
            
            <div class="modal-actions" id="goalDetailsActions">
                <button type="button" class="btn btn-secondary" id="closeDetailsModal">Close</button>
                <button type="button" class="btn btn-primary" id="editGoalBtn">Edit Goal</button>
            </div>
        </div>
    </div>
    
    <div class="goals-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="assets/images/company/logo-icon.png" alt="Infinity Mutual Funds" class="logo-image" 
                     onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>∞</text></svg>'">
                <span class="brand-name">Infinity Funds</span>
            </div>
            
            <div class="user-profile">
                <img src="assets/images/users/default-avatar.png" alt="User" class="user-avatar" id="goalsUserAvatar"
                     onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22%23667eea%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2230%22 fill=%22white%22 id=%22avatarText%22></text></svg>'">
                <h3 class="user-name" id="goalsUserName">Demo User</h3>
                <p class="user-email" id="goalsUserEmail">demo@infinityfunds.com</p>
                <span class="user-plan" id="goalsUserPlan">Premium</span>
            </div>
            
            <nav class="nav-menu">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="portfolio.html" class="nav-link">
                    <i class="fas fa-briefcase"></i>
                    <span>Portfolio</span>
                </a>
                <a href="transactions.html" class="nav-link">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transactions</span>
                </a>
                <a href="analytics.html" class="nav-link">
                    <i class="fas fa-chart-pie"></i>
                    <span>Analytics</span>
                </a>
                <a href="#" class="nav-link active">
                    <i class="fas fa-bullseye"></i>
                    <span>Financial Goals</span>
                </a>
                <a href="sip.html" class="nav-link">
                    <i class="fas fa-calendar-alt"></i>
                    <span>SIP Planner</span>
                </a>
                <a href="tax.html" class="nav-link">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Tax Center</span>
                </a>
                <a href="reports.html" class="nav-link">
                    <i class="fas fa-file-alt"></i>
                    <span>Reports</span>
                </a>
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <a href="#" class="logout-btn" id="sidebarLogout">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sign Out</span>
                </a>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <div class="welcome-message">
                    <h1>Financial Goals</h1>
                    <p>Plan, track, and achieve your financial dreams</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="goalCalculatorBtn">
                        <i class="fas fa-calculator"></i>
                        <span>Goal Calculator</span>
                    </button>
                    <button class="btn btn-primary" id="createGoalBtn">
                        <i class="fas fa-plus"></i>
                        <span>Create Goal</span>
                    </button>
                </div>
            </header>
            
            <!-- Goals Overview -->
            <div class="goals-overview">
                <div class="overview-card primary">
                    <div class="overview-header">
                        <div class="overview-icon">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <span class="status-badge status-active">Active</span>
                    </div>
                    <div class="overview-value" id="activeGoalsCount">5</div>
                    <div class="overview-label">Active Goals</div>
                    <div class="progress-bar">
                        <div class="progress-fill primary" style="width: 62%"></div>
                    </div>
                    <div class="progress-text">
                        <span>5 of 8 goals</span>
                        <span>62%</span>
                    </div>
                </div>
                
                <div class="overview-card success">
                    <div class="overview-header">
                        <div class="overview-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <span class="status-badge status-completed">Completed</span>
                    </div>
                    <div class="overview-value" id="completedGoalsCount">3</div>
                    <div class="overview-label">Completed Goals</div>
                    <div class="progress-bar">
                        <div class="progress-fill success" style="width: 38%"></div>
                    </div>
                    <div class="progress-text">
                        <span>₹12.5L achieved</span>
                        <span>38%</span>
                    </div>
                </div>
                
                <div class="overview-card warning">
                    <div class="overview-header">
                        <div class="overview-icon">
                            <i class="fas fa-rupee-sign"></i>
                        </div>
                        <span class="status-badge status-active">Active</span>
                    </div>
                    <div class="overview-value" id="totalGoalsValue">₹1.2Cr</div>
                    <div class="overview-label">Total Goals Value</div>
                    <div class="progress-bar">
                        <div class="progress-fill warning" style="width: 45%"></div>
                    </div>
                    <div class="progress-text">
                        <span>₹54L saved</span>
                        <span>45%</span>
                    </div>
                </div>
                
                <div class="overview-card info">
                    <div class="overview-header">
                        <div class="overview-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <span class="status-badge status-active">On Track</span>
                    </div>
                    <div class="overview-value" id="goalsOnTrack">4</div>
                    <div class="overview-label">Goals On Track</div>
                    <div class="progress-bar">
                        <div class="progress-fill info" style="width: 80%"></div>
                    </div>
                    <div class="progress-text">
                        <span>4 of 5 goals</span>
                        <span>80%</span>
                    </div>
                </div>
            </div>
            
            <!-- Goals Grid -->
            <div class="goals-grid" id="goalsGrid">
                <!-- Goals will be loaded here dynamically -->
            </div>
            
            <!-- Goal Timeline -->
            <div class="timeline-section">
                <div class="section-header">
                    <h2>Goal Timeline</h2>
                    <button class="btn btn-secondary" id="viewFullTimeline">
                        <i class="fas fa-calendar-alt"></i>
                        <span>View Full Timeline</span>
                    </button>
                </div>
                
                <div class="timeline-container">
                    <div class="timeline" id="goalTimeline">
                        <!-- Timeline items will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Recommendations -->
            <div class="recommendations-section">
                <div class="section-header">
                    <h2>Smart Recommendations</h2>
                </div>
                
                <div class="recommendations-grid">
                    <div class="recommendation-card">
                        <div class="recommendation-header">
                            <div class="recommendation-icon" style="background: rgba(16, 185, 129, 0.2); color: #10b981;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3 class="recommendation-title">Increase SIP for Retirement</h3>
                        </div>
                        <div class="recommendation-content">
                            Based on your retirement goal timeline, we recommend increasing your monthly SIP by ₹5,000 to stay on track for your ₹2Cr target.
                        </div>
                        <div class="recommendation-actions">
                            <button class="action-btn success">
                                <i class="fas fa-check"></i>
                                <span>Apply</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-info-circle"></i>
                                <span>Learn More</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="recommendation-card">
                        <div class="recommendation-header">
                            <div class="recommendation-icon" style="background: rgba(59, 130, 246, 0.2); color: #3b82f6;">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <h3 class="recommendation-title">Rebalance Portfolio</h3>
                        </div>
                        <div class="recommendation-content">
                            Your education fund portfolio has high equity exposure. Consider rebalancing to 60% equity, 40% debt for better risk management.
                        </div>
                        <div class="recommendation-actions">
                            <button class="action-btn primary">
                                <i class="fas fa-sync-alt"></i>
                                <span>Rebalance</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-chart-pie"></i>
                                <span>View Analysis</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="recommendation-card">
                        <div class="recommendation-header">
                            <div class="recommendation-icon" style="background: rgba(245, 158, 11, 0.2); color: #f59e0b;">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h3 class="recommendation-title">Tax Saving Opportunity</h3>
                        </div>
                        <div class="recommendation-content">
                            Consider ELSS funds for your house purchase goal to save up to ₹1.5L under Section 80C while building wealth.
                        </div>
                        <div class="recommendation-actions">
                            <button class="action-btn warning">
                                <i class="fas fa-file-invoice-dollar"></i>
                                <span>Explore ELSS</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-calculator"></i>
                                <span>Calculate Tax</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="goals-footer">
                <p>Infinity Mutual Funds - Financial Goals Planner</p>
                <p style="margin-top: 5px; font-size: 0.8rem; color: #94a3b8;">
                    <i class="fas fa-shield-alt"></i> Your goals are calculated based on 12% expected annual returns
                </p>
            </footer>
        </main>
    </div>

    <script>
        // ===== FINANCIAL GOALS DATA =====
        const financialGoals = {
            activeGoals: [
                {
                    id: 1,
                    name: 'Retirement Fund',
                    category: 'retirement',
                    targetAmount: 20000000,
                    currentSavings: 8500000,
                    timeframe: 15,
                    monthlyContribution: 25000,
                    expectedReturn: 12,
                    priority: 'high',
                    progress: 42.5,
                    status: 'active',
                    startDate: '2022-01-15',
                    description: 'Building corpus for comfortable retirement at age 60',
                    icon: 'fas fa-user-tie',
                    color: '#3b82f6'
                },
                {
                    id: 2,
                    name: 'Children\'s Education',
                    category: 'education',
                    targetAmount: 5000000,
                    currentSavings: 1200000,
                    timeframe: 8,
                    monthlyContribution: 15000,
                    expectedReturn: 14,
                    priority: 'high',
                    progress: 24,
                    status: 'active',
                    startDate: '2023-03-10',
                    description: 'Higher education fund for children',
                    icon: 'fas fa-graduation-cap',
                    color: '#10b981'
                },
                {
                    id: 3,
                    name: 'Dream House',
                    category: 'house',
                    targetAmount: 7500000,
                    currentSavings: 2000000,
                    timeframe: 5,
                    monthlyContribution: 30000,
                    expectedReturn: 10,
                    priority: 'medium',
                    progress: 26.7,
                    status: 'active',
                    startDate: '2022-08-20',
                    description: 'Down payment for new house',
                    icon: 'fas fa-home',
                    color: '#f59e0b'
                },
                {
                    id: 4,
                    name: 'European Vacation',
                    category: 'vacation',
                    targetAmount: 800000,
                    currentSavings: 320000,
                    timeframe: 2,
                    monthlyContribution: 10000,
                    expectedReturn: 8,
                    priority: 'low',
                    progress: 40,
                    status: 'active',
                    startDate: '2023-06-05',
                    description: 'Family vacation to Europe',
                    icon: 'fas fa-umbrella-beach',
                    color: '#8b5cf6'
                },
                {
                    id: 5,
                    name: 'Emergency Fund',
                    category: 'emergency',
                    targetAmount: 1000000,
                    currentSavings: 750000,
                    timeframe: 1,
                    monthlyContribution: 20000,
                    expectedReturn: 6,
                    priority: 'high',
                    progress: 75,
                    status: 'active',
                    startDate: '2023-01-01',
                    description: '6 months of living expenses',
                    icon: 'fas fa-first-aid',
                    color: '#06b6d4'
                }
            ],
            
            completedGoals: [
                {
                    id: 6,
                    name: 'New Car',
                    category: 'car',
                    targetAmount: 1500000,
                    currentSavings: 1500000,
                    timeframe: 3,
                    monthlyContribution: 35000,
                    expectedReturn: 10,
                    priority: 'medium',
                    progress: 100,
                    status: 'completed',
                    startDate: '2020-05-15',
                    endDate: '2023-05-15',
                    description: 'Purchased new SUV',
                    icon: 'fas fa-car',
                    color: '#ef4444'
                },
                {
                    id: 7,
                    name: 'Wedding Fund',
                    category: 'wedding',
                    targetAmount: 1000000,
                    currentSavings: 1000000,
                    timeframe: 2,
                    monthlyContribution: 35000,
                    expectedReturn: 9,
                    priority: 'high',
                    progress: 100,
                    status: 'completed',
                    startDate: '2021-08-10',
                    endDate: '2023-08-10',
                    description: 'Sister\'s wedding expenses',
                    icon: 'fas fa-ring',
                    color: '#ec4899'
                },
                {
                    id: 8,
                    name: 'Gadget Upgrade',
                    category: 'other',
                    targetAmount: 200000,
                    currentSavings: 200000,
                    timeframe: 1,
                    monthlyContribution: 15000,
                    expectedReturn: 8,
                    priority: 'low',
                    progress: 100,
                    status: 'completed',
                    startDate: '2023-01-01',
                    endDate: '2023-12-01',
                    description: 'New laptop and smartphone',
                    icon: 'fas fa-laptop',
                    color: '#64748b'
                }
            ]
        };

        // ===== GOALS INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Financial Goals page loaded - Initializing...');
            
            // DOM Elements
            const sidebar = document.getElementById('sidebar');
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const notification = document.getElementById('notification');
            const notificationMessage = document.getElementById('notificationMessage');
            const sidebarLogout = document.getElementById('sidebarLogout');
            const createGoalBtn = document.getElementById('createGoalBtn');
            const goalCalculatorBtn = document.getElementById('goalCalculatorBtn');
            const goalsGrid = document.getElementById('goalsGrid');
            const goalTimeline = document.getElementById('goalTimeline');
            const viewFullTimeline = document.getElementById('viewFullTimeline');
            const goalsUserName = document.getElementById('goalsUserName');
            const goalsUserEmail = document.getElementById('goalsUserEmail');
            const goalsUserAvatar = document.getElementById('goalsUserAvatar');
            const avatarText = document.getElementById('avatarText');
            const goalsUserPlan = document.getElementById('goalsUserPlan');
            
            // Modal Elements
            const createGoalModal = document.getElementById('createGoalModal');
            const goalDetailsModal = document.getElementById('goalDetailsModal');
            const closeCreateGoalModal = document.getElementById('closeCreateGoalModal');
            const closeGoalDetailsModal = document.getElementById('closeGoalDetailsModal');
            const cancelCreateGoal = document.getElementById('cancelCreateGoal');
            const createGoalForm = document.getElementById('createGoalForm');
            const goalDetailsContent = document.getElementById('goalDetailsContent');
            const closeDetailsModal = document.getElementById('closeDetailsModal');
            const editGoalBtn = document.getElementById('editGoalBtn');
            
            // Variables
            let currentGoalId = null;
            
            // ===== USER AUTHENTICATION CHECK =====
            function checkAuth() {
                try {
                    const userData = localStorage.getItem('infinity_user');
                    if (!userData) {
                        // No user found, redirect to login
                        showNotification('Please login to access financial goals', 'warning');
                        setTimeout(() => {
                            window.location.href = 'index.html';
                        }, 2000);
                        return null;
                    }
                    
                    const user = JSON.parse(userData);
                    
                    // Update UI with user data
                    if (goalsUserName) {
                        goalsUserName.textContent = user.name;
                    }
                    
                    if (goalsUserEmail) {
                        goalsUserEmail.textContent = user.email;
                    }
                    
                    if (avatarText) {
                        const initials = user.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                        avatarText.textContent = initials;
                    }
                    
                    if (goalsUserPlan) {
                        goalsUserPlan.textContent = user.plan || 'Premium';
                    }
                    
                    return user;
                } catch (error) {
                    console.error('Auth check error:', error);
                    return null;
                }
            }
            
            const currentUser = checkAuth();
            
            // ===== INITIALIZE GOALS =====
            function initGoals() {
                // Load goals data
                loadGoalsData();
                
                // Load timeline
                loadGoalTimeline();
                
                // Update overview stats
                updateOverviewStats();
                
                // Initialize event listeners
                initEventListeners();
                
                // Set today's date in date inputs
                setTodayDate();
            }
            
            // ===== LOAD GOALS DATA =====
            function loadGoalsData() {
                if (!goalsGrid) return;
                
                // Clear existing goals
                goalsGrid.innerHTML = '';
                
                // Combine active and completed goals
                const allGoals = [...financialGoals.activeGoals, ...financialGoals.completedGoals];
                
                // Sort by priority (high to low) and then by progress
                allGoals.sort((a, b) => {
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    if (priorityOrder[b.priority] !== priorityOrder[a.priority]) {
                        return priorityOrder[b.priority] - priorityOrder[a.priority];
                    }
                    return b.progress - a.progress;
                });
                
                // Create goal cards
                allGoals.forEach(goal => {
                    const goalCard = createGoalCard(goal);
                    goalsGrid.appendChild(goalCard);
                });
            }
            
            // ===== CREATE GOAL CARD =====
            function createGoalCard(goal) {
                const card = document.createElement('div');
                card.className = `goal-card priority-${goal.priority}`;
                card.dataset.goalId = goal.id;
                
                // Calculate metrics
                const monthsToGo = goal.timeframe * 12;
                const monthlyNeeded = calculateMonthlyInvestment(
                    goal.targetAmount - goal.currentSavings,
                    goal.expectedReturn,
                    goal.timeframe
                );
                const isOnTrack = goal.monthlyContribution >= monthlyNeeded * 0.9;
                const statusClass = goal.status === 'completed' ? 'status-completed' : 
                                  isOnTrack ? 'status-active' : 'status-delayed';
                const statusText = goal.status === 'completed' ? 'Completed' : 
                                 isOnTrack ? 'On Track' : 'Needs Attention';
                
                // Get category icon class
                const categoryIconClass = getCategoryIconClass(goal.category);
                
                card.innerHTML = `
                    <div class="goal-card-header">
                        <div class="goal-category">
                            <div class="category-icon ${categoryIconClass}">
                                <i class="${goal.icon}"></i>
                            </div>
                            <div>
                                <h3 class="goal-title">${goal.name}</h3>
                                <p class="goal-subtitle">${goal.category.charAt(0).toUpperCase() + goal.category.slice(1)}</p>
                            </div>
                        </div>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="goal-details">
                        <div class="progress-bar">
                            <div class="progress-fill ${goal.priority}" style="width: ${goal.progress}%"></div>
                        </div>
                        <div class="progress-text">
                            <span>₹${formatCurrency(goal.currentSavings)} saved</span>
                            <span>${goal.progress}%</span>
                        </div>
                    </div>
                    
                    <div class="goal-metrics">
                        <div class="goal-metric">
                            <div class="metric-value">₹${formatCurrencyShort(goal.targetAmount)}</div>
                            <div class="metric-label">Target Amount</div>
                        </div>
                        <div class="goal-metric">
                            <div class="metric-value">${goal.timeframe}Y</div>
                            <div class="metric-label">Timeframe</div>
                        </div>
                        <div class="goal-metric">
                            <div class="metric-value">${goal.expectedReturn}%</div>
                            <div class="metric-label">Expected Return</div>
                        </div>
                        <div class="goal-metric">
                            <div class="metric-value">₹${formatCurrencyShort(goal.monthlyContribution)}</div>
                            <div class="metric-label">Monthly</div>
                        </div>
                    </div>
                    
                    <div class="goal-actions">
                        <button class="action-btn view-details" data-goal-id="${goal.id}">
                            <i class="fas fa-eye"></i>
                            <span>View Details</span>
                        </button>
                        <button class="action-btn ${goal.status === 'completed' ? 'success' : 'primary'} track-progress" data-goal-id="${goal.id}">
                            <i class="fas fa-chart-line"></i>
                            <span>${goal.status === 'completed' ? 'Completed' : 'Track'}</span>
                        </button>
                    </div>
                `;
                
                return card;
            }
            
            // ===== LOAD GOAL TIMELINE =====
            function loadGoalTimeline() {
                if (!goalTimeline) return;
                
                // Clear existing timeline
                goalTimeline.innerHTML = '';
                
                // Get upcoming milestones from active goals
                const upcomingMilestones = [];
                
                financialGoals.activeGoals.forEach(goal => {
                    const milestoneDate = new Date(goal.startDate);
                    milestoneDate.setFullYear(milestoneDate.getFullYear() + goal.timeframe);
                    
                    upcomingMilestones.push({
                        date: milestoneDate,
                        title: `${goal.name} Target Date`,
                        description: `Target: ₹${formatCurrency(goal.targetAmount)}`,
                        status: 'upcoming',
                        goalId: goal.id
                    });
                    
                    // Add quarterly progress checkpoints
                    for (let i = 1; i <= 4; i++) {
                        const checkpointDate = new Date(goal.startDate);
                        checkpointDate.setMonth(checkpointDate.getMonth() + (i * 3));
                        
                        if (checkpointDate < new Date()) {
                            upcomingMilestones.push({
                                date: checkpointDate,
                                title: `${goal.name} Q${i} Review`,
                                description: 'Quarterly progress check',
                                status: 'completed',
                                goalId: goal.id
                            });
                        }
                    }
                });
                
                // Sort by date
                upcomingMilestones.sort((a, b) => a.date - b.date);
                
                // Take next 5 milestones
                const nextMilestones = upcomingMilestones.slice(0, 5);
                
                // Create timeline items
                nextMilestones.forEach(milestone => {
                    const timelineItem = createTimelineItem(milestone);
                    goalTimeline.appendChild(timelineItem);
                });
            }
            
            // ===== CREATE TIMELINE ITEM =====
            function createTimelineItem(milestone) {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                
                const dateStr = milestone.date.toLocaleDateString('en-IN', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                const statusColor = milestone.status === 'completed' ? '#10b981' : 
                                  milestone.status === 'current' ? '#3b82f6' : '#f59e0b';
                
                item.innerHTML = `
                    <div class="timeline-marker" style="border-color: ${statusColor};"></div>
                    <div class="timeline-content">
                        <div class="timeline-date">${dateStr}</div>
                        <h4 class="timeline-title">${milestone.title}</h4>
                        <p class="timeline-description">${milestone.description}</p>
                    </div>
                `;
                
                return item;
            }
            
            // ===== UPDATE OVERVIEW STATS =====
            function updateOverviewStats() {
                // Update active goals count
                const activeGoalsCount = document.getElementById('activeGoalsCount');
                if (activeGoalsCount) {
                    activeGoalsCount.textContent = financialGoals.activeGoals.length;
                }
                
                // Update completed goals count
                const completedGoalsCount = document.getElementById('completedGoalsCount');
                if (completedGoalsCount) {
                    completedGoalsCount.textContent = financialGoals.completedGoals.length;
                }
                
                // Update total goals value
                const totalGoalsValue = document.getElementById('totalGoalsValue');
                if (totalGoalsValue) {
                    const totalValue = [...financialGoals.activeGoals, ...financialGoals.completedGoals]
                        .reduce((sum, goal) => sum + goal.targetAmount, 0);
                    totalGoalsValue.textContent = formatCurrency(totalValue);
                }
                
                // Update goals on track
                const goalsOnTrack = document.getElementById('goalsOnTrack');
                if (goalsOnTrack) {
                    const onTrackCount = financialGoals.activeGoals.filter(goal => {
                        const monthlyNeeded = calculateMonthlyInvestment(
                            goal.targetAmount - goal.currentSavings,
                            goal.expectedReturn,
                            goal.timeframe
                        );
                        return goal.monthlyContribution >= monthlyNeeded * 0.9;
                    }).length;
                    goalsOnTrack.textContent = onTrackCount;
                }
            }
            
            // ===== INITIALIZE EVENT LISTENERS =====
            function initEventListeners() {
                // Mobile menu toggle
                if (mobileMenuToggle) {
                    mobileMenuToggle.addEventListener('click', function() {
                        sidebar.classList.toggle('active');
                    });
                }
                
                // Close sidebar when clicking outside on mobile
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 1024) {
                        if (!sidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                            sidebar.classList.remove('active');
                        }
                    }
                });
                
                // Logout
                if (sidebarLogout) {
                    sidebarLogout.addEventListener('click', function(e) {
                        e.preventDefault();
                        if (confirm('Are you sure you want to sign out?')) {
                            localStorage.removeItem('infinity_user');
                            showNotification('Signed out successfully', 'success');
                            setTimeout(() => {
                                window.location.href = 'index.html';
                            }, 1500);
                        }
                    });
                }
                
                // Create Goal button
                if (createGoalBtn) {
                    createGoalBtn.addEventListener('click', function() {
                        openModal(createGoalModal);
                    });
                }
                
                // Goal Calculator button
                if (goalCalculatorBtn) {
                    goalCalculatorBtn.addEventListener('click', function() {
                        showNotification('Goal calculator feature coming soon!', 'info');
                    });
                }
                
                // View Full Timeline button
                if (viewFullTimeline) {
                    viewFullTimeline.addEventListener('click', function() {
                        showNotification('Full timeline view coming soon!', 'info');
                    });
                }
                
                // Modal close buttons
                if (closeCreateGoalModal) {
                    closeCreateGoalModal.addEventListener('click', function() {
                        closeModal(createGoalModal);
                    });
                }
                
                if (closeGoalDetailsModal) {
                    closeGoalDetailsModal.addEventListener('click', function() {
                        closeModal(goalDetailsModal);
                    });
                }
                
                if (cancelCreateGoal) {
                    cancelCreateGoal.addEventListener('click', function() {
                        closeModal(createGoalModal);
                    });
                }
                
                if (closeDetailsModal) {
                    closeDetailsModal.addEventListener('click', function() {
                        closeModal(goalDetailsModal);
                    });
                }
                
                // Edit Goal button
                if (editGoalBtn) {
                    editGoalBtn.addEventListener('click', function() {
                        if (currentGoalId) {
                            showNotification('Edit goal feature coming soon!', 'info');
                        }
                    });
                }
                
                // Close modals when clicking outside
                window.addEventListener('click', function(e) {
                    if (e.target === createGoalModal) {
                        closeModal(createGoalModal);
                    }
                    if (e.target === goalDetailsModal) {
                        closeModal(goalDetailsModal);
                    }
                });
                
                // Form submission
                if (createGoalForm) {
                    createGoalForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        createNewGoal();
                    });
                }
                
                // Event delegation for goal cards
                goalsGrid.addEventListener('click', function(e) {
                    const viewDetailsBtn = e.target.closest('.view-details');
                    const trackProgressBtn = e.target.closest('.track-progress');
                    
                    if (viewDetailsBtn) {
                        const goalId = viewDetailsBtn.dataset.goalId;
                        showGoalDetails(goalId);
                    }
                    
                    if (trackProgressBtn) {
                        const goalId = trackProgressBtn.dataset.goalId;
                        trackGoalProgress(goalId);
                    }
                });
            }
            
            // ===== SHOW GOAL DETAILS =====
            function showGoalDetails(goalId) {
                // Find the goal
                const allGoals = [...financialGoals.activeGoals, ...financialGoals.completedGoals];
                const goal = allGoals.find(g => g.id == goalId);
                
                if (!goal) return;
                
                // Set current goal ID
                currentGoalId = goalId;
                
                // Update modal title
                document.getElementById('detailsGoalTitle').textContent = goal.name;
                
                // Calculate metrics
                const monthlyNeeded = calculateMonthlyInvestment(
                    goal.targetAmount - goal.currentSavings,
                    goal.expectedReturn,
                    goal.timeframe
                );
                
                const projectedValue = calculateFutureValue(
                    goal.currentSavings,
                    goal.monthlyContribution,
                    goal.expectedReturn,
                    goal.timeframe
                );
                
                const shortfall = goal.targetAmount - projectedValue;
                const isOnTrack = shortfall <= 0;
                
                // Get category display name
                const categoryDisplay = goal.category.charAt(0).toUpperCase() + goal.category.slice(1);
                
                // Update goal details content
                goalDetailsContent.innerHTML = `
                    <div class="goal-details">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div class="category-icon ${getCategoryIconClass(goal.category)}" style="width: 60px; height: 60px; font-size: 1.5rem;">
                                <i class="${goal.icon}"></i>
                            </div>
                            <div>
                                <h3 style="color: white; margin-bottom: 5px;">${goal.name}</h3>
                                <div style="display: flex; gap: 10px;">
                                    <span class="status-badge priority-${goal.priority}">${goal.priority.toUpperCase()}</span>
                                    <span class="status-badge ${goal.status === 'completed' ? 'status-completed' : isOnTrack ? 'status-active' : 'status-delayed'}">
                                        ${goal.status === 'completed' ? 'Completed' : isOnTrack ? 'On Track' : 'Needs Attention'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <p style="color: #cbd5e1;">${goal.description}</p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 25px;">
                            <div>
                                <div style="color: #cbd5e1; font-size: 0.9rem; margin-bottom: 5px;">Target Amount</div>
                                <div style="color: white; font-size: 1.5rem; font-weight: 600;">₹${formatCurrency(goal.targetAmount)}</div>
                            </div>
                            <div>
                                <div style="color: #cbd5e1; font-size: 0.9rem; margin-bottom: 5px;">Current Savings</div>
                                <div style="color: white; font-size: 1.5rem; font-weight: 600;">₹${formatCurrency(goal.currentSavings)}</div>
                            </div>
                            <div>
                                <div style="color: #cbd5e1; font-size: 0.9rem; margin-bottom: 5px;">Timeframe</div>
                                <div style="color: white; font-size: 1.5rem; font-weight: 600;">${goal.timeframe} Years</div>
                            </div>
                            <div>
                                <div style="color: #cbd5e1; font-size: 0.9rem; margin-bottom: 5px;">Expected Return</div>
                                <div style="color: white; font-size: 1.5rem; font-weight: 600;">${goal.expectedReturn}%</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <div style="color: #cbd5e1;">Progress</div>
                                <div style="color: white; font-weight: 600;">${goal.progress}%</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill ${goal.priority}" style="width: ${goal.progress}%"></div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                            <h4 style="color: white; margin-bottom: 15px;">Investment Plan</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                <div>
                                    <div style="color: #cbd5e1; font-size: 0.9rem;">Monthly Contribution</div>
                                    <div style="color: white; font-weight: 600;">₹${formatCurrency(goal.monthlyContribution)}</div>
                                </div>
                                <div>
                                    <div style="color: #cbd5e1; font-size: 0.9rem;">Required Monthly</div>
                                    <div style="color: ${monthlyNeeded > goal.monthlyContribution ? '#ef4444' : '#10b981'}; font-weight: 600;">
                                        ₹${formatCurrency(monthlyNeeded)}
                                    </div>
                                </div>
                                <div>
                                    <div style="color: #cbd5e1; font-size: 0.9rem;">Projected Value</div>
                                    <div style="color: white; font-weight: 600;">₹${formatCurrency(projectedValue)}</div>
                                </div>
                                <div>
                                    <div style="color: #cbd5e1; font-size: 0.9rem;">Shortfall/Surplus</div>
                                    <div style="color: ${shortfall > 0 ? '#ef4444' : '#10b981'}; font-weight: 600;">
                                        ${shortfall > 0 ? '-' : '+'}₹${formatCurrency(Math.abs(shortfall))}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: white; margin-bottom: 10px;">Goal Timeline</h4>
                            <div style="color: #cbd5e1; font-size: 0.9rem;">
                                Started: ${new Date(goal.startDate).toLocaleDateString('en-IN')}
                                ${goal.endDate ? `<br>Completed: ${new Date(goal.endDate).toLocaleDateString('en-IN')}` : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                // Open modal
                openModal(goalDetailsModal);
            }
            
            // ===== TRACK GOAL PROGRESS =====
            function trackGoalProgress(goalId) {
                const allGoals = [...financialGoals.activeGoals, ...financialGoals.completedGoals];
                const goal = allGoals.find(g => g.id == goalId);
                
                if (!goal) return;
                
                if (goal.status === 'completed') {
                    showNotification(`${goal.name} has been completed! Congratulations!`, 'success');
                } else {
                    showNotification(`Tracking progress for ${goal.name}...`, 'info');
                    // In a real app, this would open a detailed progress tracking page
                }
            }
            
            // ===== CREATE NEW GOAL =====
            function createNewGoal() {
                const submitBtn = document.getElementById('submitCreateGoal');
                const submitText = document.getElementById('submitCreateGoalText');
                const submitLoading = document.getElementById('submitCreateGoalLoading');
                
                // Show loading
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.style.display = 'inline-block';
                
                // Get form values
                const goalData = {
                    id: financialGoals.activeGoals.length + financialGoals.completedGoals.length + 1,
                    name: document.getElementById('goalName').value,
                    category: document.getElementById('goalCategory').value,
                    targetAmount: parseFloat(document.getElementById('targetAmount').value),
                    currentSavings: parseFloat(document.getElementById('currentSavings').value) || 0,
                    timeframe: parseFloat(document.getElementById('timeframe').value),
                    monthlyContribution: parseFloat(document.getElementById('monthlyContribution').value) || 0,
                    expectedReturn: parseFloat(document.getElementById('expectedReturn').value),
                    priority: document.getElementById('goalPriority').value,
                    description: document.getElementById('goalDescription').value || '',
                    status: 'active',
                    startDate: new Date().toISOString().split('T')[0]
                };
                
                // Calculate progress
                goalData.progress = (goalData.currentSavings / goalData.targetAmount) * 100;
                
                // Set icon and color based on category
                const { icon, color } = getCategoryDetails(goalData.category);
                goalData.icon = icon;
                goalData.color = color;
                
                // Simulate API call
                setTimeout(() => {
                    // Add new goal
                    financialGoals.activeGoals.push(goalData);
                    
                    // Reset form
                    createGoalForm.reset();
                    
                    // Close modal
                    closeModal(createGoalModal);
                    
                    // Reload goals
                    loadGoalsData();
                    updateOverviewStats();
                    loadGoalTimeline();
                    
                    // Show success message
                    showNotification('New financial goal created successfully!', 'success');
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitText.style.display = 'inline';
                    submitLoading.style.display = 'none';
                }, 1500);
            }
            
            // ===== UTILITY FUNCTIONS =====
            function showNotification(message, type = 'success') {
                if (!notification || !notificationMessage) return;
                
                // Set message
                notificationMessage.textContent = message;
                
                // Set color based on type
                const colors = {
                    success: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                    warning: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
                    error: 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)',
                    info: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)'
                };
                
                notification.style.background = colors[type] || colors.success;
                
                // Show notification
                notification.classList.add('show');
                
                // Auto hide after 5 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 5000);
            }
            
            function formatCurrency(amount) {
                if (amount >= 10000000) {
                    return (amount / 10000000).toFixed(2) + 'Cr';
                } else if (amount >= 100000) {
                    return (amount / 100000).toFixed(2) + 'L';
                } else if (amount >= 1000) {
                    return (amount / 1000).toFixed(1) + 'K';
                }
                return amount.toFixed(2);
            }
            
            function formatCurrencyShort(amount) {
                if (amount >= 100000) {
                    return (amount / 100000).toFixed(1) + 'L';
                } else if (amount >= 1000) {
                    return (amount / 1000).toFixed(1) + 'K';
                }
                return amount;
            }
            
            function openModal(modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
            
            function closeModal(modal) {
                modal.classList.remove('show');
                document.body.style.overflow = '';
            }
            
            function calculateMonthlyInvestment(futureValue, annualRate, years) {
                const monthlyRate = annualRate / 100 / 12;
                const months = years * 12;
                
                if (monthlyRate === 0) {
                    return futureValue / months;
                }
                
                return (futureValue * monthlyRate) / (Math.pow(1 + monthlyRate, months) - 1);
            }
            
            function calculateFutureValue(presentValue, monthlyContribution, annualRate, years) {
                const monthlyRate = annualRate / 100 / 12;
                const months = years * 12;
                
                // Future value of lump sum
                let futureValue = presentValue * Math.pow(1 + monthlyRate, months);
                
                // Future value of monthly contributions
                if (monthlyContribution > 0) {
                    futureValue += monthlyContribution * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate);
                }
                
                return futureValue;
            }
            
            function getCategoryIconClass(category) {
                const iconMap = {
                    retirement: 'retirement',
                    house: 'house',
                    education: 'education',
                    car: 'car',
                    vacation: 'vacation',
                    wedding: 'wedding',
                    emergency: 'emergency',
                    other: 'other'
                };
                
                return iconMap[category] || 'other';
            }
            
            function getCategoryDetails(category) {
                const details = {
                    retirement: { icon: 'fas fa-user-tie', color: '#3b82f6' },
                    house: { icon: 'fas fa-home', color: '#10b981' },
                    education: { icon: 'fas fa-graduation-cap', color: '#f59e0b' },
                    car: { icon: 'fas fa-car', color: '#ef4444' },
                    vacation: { icon: 'fas fa-umbrella-beach', color: '#8b5cf6' },
                    wedding: { icon: 'fas fa-ring', color: '#ec4899' },
                    emergency: { icon: 'fas fa-first-aid', color: '#06b6d4' },
                    other: { icon: 'fas fa-bullseye', color: '#64748b' }
                };
                
                return details[category] || details.other;
            }
            
            function setTodayDate() {
                const today = new Date().toISOString().split('T')[0];
                // Set any date inputs that should default to today
            }
            
            // ===== INITIALIZE GOALS =====
            if (currentUser) {
                initGoals();
            }
        });
    </script>
</body>
</html>
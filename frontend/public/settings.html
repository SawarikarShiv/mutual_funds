<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings | Infinity Mutual Funds</title>
    <meta name="description" content="Manage your account settings, preferences, and security">
    <meta name="author" content="Infinity Financial Services">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/components.css">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            --info-gradient: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(rgba(10, 15, 46, 0.95), rgba(26, 31, 78, 0.95)), url('assets/images/dashboard/hero-bg.png');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .settings-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo-image {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            object-fit: contain;
        }
        
        .brand-name {
            color: white;
            font-size: 18px;
            font-weight: 600;
        }
        
        .user-profile {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 3px solid #667eea;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .user-avatar:hover {
            transform: scale(1.05);
        }
        
        .user-name {
            color: white;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .user-email {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .user-plan {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #cbd5e1;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            color: white;
            border-left: 3px solid #667eea;
        }
        
        .nav-link i {
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logout-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #ef4444;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        
        /* Main Content Styles */
        .main-content {
            padding: 30px;
            overflow-y: auto;
        }
        
        .settings-header {
            margin-bottom: 30px;
        }
        
        .settings-header h1 {
            color: white;
            margin-bottom: 10px;
        }
        
        .settings-header p {
            color: #cbd5e1;
        }
        
        /* Settings Navigation */
        .settings-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }
        
        .settings-tab {
            padding: 12px 25px;
            background: transparent;
            border: none;
            color: #cbd5e1;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-tab:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .settings-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .settings-tab i {
            font-size: 1.1rem;
        }
        
        /* Settings Content */
        .settings-content {
            display: none;
        }
        
        .settings-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Settings Card */
        .settings-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }
        
        .settings-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .settings-card-header i {
            font-size: 1.5rem;
            color: #667eea;
            width: 40px;
            height: 40px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .settings-card-header h2 {
            color: white;
            font-size: 1.5rem;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #e2e8f0;
            font-size: 14px;
            font-weight: 500;
        }
        
        .form-group .label-info {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 16px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-control.error {
            border-color: #ef4444;
        }
        
        .form-control.success {
            border-color: #10b981;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }
        
        /* Checkbox */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
        }
        
        /* Radio Button Group */
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        /* Button Styles */
        .btn {
            padding: 14px 30px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            font-size: 15px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
        }
        
        /* Security Status */
        .security-status {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .security-status-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .security-status-header i {
            color: #10b981;
            font-size: 1.5rem;
        }
        
        .security-status-header h3 {
            color: white;
            margin: 0;
        }
        
        .security-status-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .security-status-item:last-child {
            border-bottom: none;
        }
        
        .security-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .security-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .security-icon.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .security-icon.warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .security-icon.danger {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .security-text h4 {
            color: white;
            margin-bottom: 5px;
        }
        
        .security-text p {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin: 0;
        }
        
        /* Plan Card */
        .plan-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 25px;
        }
        
        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .plan-header h3 {
            color: white;
            margin: 0;
        }
        
        .plan-price {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .plan-features {
            list-style: none;
            padding: 0;
            margin-bottom: 25px;
        }
        
        .plan-features li {
            color: #e2e8f0;
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .plan-features li i {
            color: #10b981;
        }
        
        /* Connected Apps */
        .connected-apps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .app-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .app-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .app-info {
            flex: 1;
        }
        
        .app-info h4 {
            color: white;
            margin-bottom: 5px;
        }
        
        .app-info p {
            color: #cbd5e1;
            font-size: 0.85rem;
            margin: 0;
        }
        
        .app-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Activity Log */
        .activity-log {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .activity-icon.login {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .activity-icon.password {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .activity-icon.device {
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
        }
        
        .activity-icon.profile {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .activity-details {
            flex: 1;
        }
        
        .activity-details h4 {
            color: white;
            margin-bottom: 5px;
        }
        
        .activity-details p {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin: 0;
        }
        
        .activity-time {
            color: #94a3b8;
            font-size: 0.85rem;
        }
        
        /* Danger Zone */
        .danger-zone {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin-top: 40px;
        }
        
        .danger-zone-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .danger-zone-header i {
            color: #ef4444;
            font-size: 1.5rem;
        }
        
        .danger-zone-header h2 {
            color: white;
            margin: 0;
        }
        
        .danger-zone-item {
            padding: 20px 0;
            border-bottom: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        .danger-zone-item:last-child {
            border-bottom: none;
        }
        
        .danger-zone-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .danger-zone-info h4 {
            color: white;
            margin-bottom: 5px;
        }
        
        .danger-zone-info p {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin: 0;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            animation: slideIn 0.5s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            display: none;
        }
        
        .notification.show {
            display: flex;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .modal-header h2 {
            color: white;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: white;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .settings-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                z-index: 1000;
                transition: left 0.3s ease;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-menu-toggle {
                display: block;
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: white;
                width: 50px;
                height: 50px;
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
        
        @media (max-width: 768px) {
            .settings-nav {
                flex-wrap: wrap;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .connected-apps {
                grid-template-columns: 1fr;
            }
            
            .danger-zone-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .danger-zone-content .btn {
                width: 100%;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Password Strength Meter */
        .password-strength {
            margin-top: 10px;
        }
        
        .strength-meter {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .strength-bar {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .strength-bar.weak {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            width: 25%;
        }
        
        .strength-bar.fair {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            width: 50%;
        }
        
        .strength-bar.good {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            width: 75%;
        }
        
        .strength-bar.strong {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            width: 100%;
        }
        
        .strength-text {
            color: #cbd5e1;
            font-size: 0.85rem;
        }
        
        /* File Upload */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #cbd5e1;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-upload-label:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #667eea;
        }
        
        .file-upload-label i {
            font-size: 2rem;
            color: #667eea;
        }
        
        .file-upload-label span {
            text-align: center;
        }
        
        .file-upload-label .file-info {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationMessage">Settings saved successfully!</span>
    </div>
    
    <!-- Mobile Menu Toggle -->
    <div class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Change Password</h2>
                <button class="close-modal" id="closePasswordModal">&times;</button>
            </div>
            <form id="changePasswordForm">
                <div class="form-group">
                    <label for="currentPassword">Current Password</label>
                    <input type="password" id="currentPassword" class="form-control" placeholder="Enter current password" required>
                </div>
                
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" class="form-control" placeholder="Enter new password" required>
                    <div class="password-strength">
                        <div class="strength-meter">
                            <div class="strength-bar" id="passwordStrengthBar"></div>
                        </div>
                        <div class="strength-text" id="passwordStrengthText">Password strength</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirm New Password</label>
                    <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm new password" required>
                    <div class="error-message" id="passwordError" style="color: #ef4444; font-size: 0.9rem; margin-top: 5px; display: none;">
                        Passwords do not match
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelPasswordChange">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitPasswordChange">
                        <span id="submitPasswordText">Change Password</span>
                        <span id="submitPasswordLoading" class="loading" style="display: none;"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Delete Account Modal -->
    <div class="modal" id="deleteAccountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Delete Account</h2>
                <button class="close-modal" id="closeDeleteModal">&times;</button>
            </div>
            <div class="form-group">
                <p style="color: #cbd5e1; margin-bottom: 20px;">
                    Are you sure you want to delete your account? This action cannot be undone. 
                    All your data, including portfolio information and transaction history, will be permanently deleted.
                </p>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="confirmDelete" required>
                    <label for="confirmDelete" style="color: white;">
                        I understand that this action is permanent and cannot be undone
                    </label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="confirmDataLoss" required>
                    <label for="confirmDataLoss" style="color: white;">
                        I understand that all my data will be permanently deleted
                    </label>
                </div>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="deleteReason">Reason for leaving (optional)</label>
                    <textarea id="deleteReason" class="form-control" rows="3" placeholder="Help us improve by telling us why you're leaving"></textarea>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancelDeleteAccount">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteAccount" disabled>
                    <span id="deleteAccountText">Delete Account</span>
                    <span id="deleteAccountLoading" class="loading" style="display: none;"></span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Export Data Modal -->
    <div class="modal" id="exportDataModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Data</h2>
                <button class="close-modal" id="closeExportModal">&times;</button>
            </div>
            <div class="form-group">
                <p style="color: #cbd5e1; margin-bottom: 20px;">
                    Select the data you want to export. Your data will be exported in CSV format.
                </p>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="exportPortfolio" checked>
                    <label for="exportPortfolio" style="color: white;">Portfolio Holdings</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="exportTransactions" checked>
                    <label for="exportTransactions" style="color: white;">Transaction History</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="exportTaxData" checked>
                    <label for="exportTaxData" style="color: white;">Tax Data</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="exportReports" checked>
                    <label for="exportReports" style="color: white;">Generated Reports</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="exportProfile" checked>
                    <label for="exportProfile" style="color: white;">Profile Information</label>
                </div>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="exportFormat">Export Format</label>
                    <select id="exportFormat" class="form-control">
                        <option value="csv">CSV (Comma Separated Values)</option>
                        <option value="excel">Excel (.xlsx)</option>
                        <option value="pdf">PDF Document</option>
                        <option value="json">JSON (Raw Data)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="dateRange">Date Range</label>
                    <select id="dateRange" class="form-control">
                        <option value="all">All Time</option>
                        <option value="1year">Last 1 Year</option>
                        <option value="3years">Last 3 Years</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="cancelExport">Cancel</button>
                <button type="button" class="btn btn-primary" id="startExport">
                    <span id="exportText">Export Data</span>
                    <span id="exportLoading" class="loading" style="display: none;"></span>
                </button>
            </div>
        </div>
    </div>
    
    <div class="settings-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="assets/images/company/logo-icon.png" alt="Infinity Mutual Funds" class="logo-image" 
                     onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âˆž</text></svg>'">
                <span class="brand-name">Infinity Funds</span>
            </div>
            
            <div class="user-profile">
                <img src="assets/images/users/default-avatar.png" alt="User" class="user-avatar" id="settingsUserAvatar"
                     onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22%23667eea%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2230%22 fill=%22white%22 id=%22avatarText%22></text></svg>'">
                <h3 class="user-name" id="settingsUserName">Demo User</h3>
                <p class="user-email" id="settingsUserEmail">demo@infinityfunds.com</p>
                <span class="user-plan" id="settingsUserPlan">Premium</span>
            </div>
            
            <nav class="nav-menu">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="portfolio.html" class="nav-link">
                    <i class="fas fa-briefcase"></i>
                    <span>Portfolio</span>
                </a>
                <a href="analytics.html" class="nav-link">
                    <i class="fas fa-chart-pie"></i>
                    <span>Analytics</span>
                </a>
                <a href="#" class="nav-link active">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <a href="#" class="logout-btn" id="sidebarLogout">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sign Out</span>
                </a>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <header class="settings-header">
                <h1>Account Settings</h1>
                <p>Manage your account preferences, security, and data</p>
            </header>
            
            <!-- Settings Navigation -->
            <div class="settings-nav">
                <button class="settings-tab active" data-tab="profile">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </button>
                <button class="settings-tab" data-tab="security">
                    <i class="fas fa-shield-alt"></i>
                    <span>Security</span>
                </button>
                <button class="settings-tab" data-tab="notifications">
                    <i class="fas fa-bell"></i>
                    <span>Notifications</span>
                </button>
                <button class="settings-tab" data-tab="preferences">
                    <i class="fas fa-sliders-h"></i>
                    <span>Preferences</span>
                </button>
                <button class="settings-tab" data-tab="subscription">
                    <i class="fas fa-crown"></i>
                    <span>Subscription</span>
                </button>
                <button class="settings-tab" data-tab="connected-apps">
                    <i class="fas fa-plug"></i>
                    <span>Connected Apps</span>
                </button>
                <button class="settings-tab" data-tab="privacy">
                    <i class="fas fa-lock"></i>
                    <span>Privacy</span>
                </button>
            </div>
            
            <!-- Profile Settings -->
            <div class="settings-content active" id="profileContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-user-circle"></i>
                        <h2>Personal Information</h2>
                    </div>
                    
                    <form id="profileForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">First Name</label>
                                <input type="text" id="firstName" class="form-control" value="Demo" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="lastName">Last Name</label>
                                <input type="text" id="lastName" class="form-control" value="User" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" class="form-control" value="demo@infinityfunds.com" required>
                                <div class="label-info">Your email address is used for login and notifications</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" class="form-control" value="+91 98765 43210" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="address">Address</label>
                            <textarea id="address" class="form-control" rows="3" placeholder="Enter your address">Mumbai, India</textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="dob">Date of Birth</label>
                                <input type="date" id="dob" class="form-control" value="1990-01-01">
                            </div>
                            
                            <div class="form-group">
                                <label for="pan">PAN Number</label>
                                <input type="text" id="pan" class="form-control" placeholder="ABCDE1234F" maxlength="10" value="ABCDE1234F">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Profile Picture</label>
                            <div class="file-upload">
                                <input type="file" id="profilePicture" accept="image/*">
                                <div class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <div>
                                        <div>Click to upload or drag and drop</div>
                                        <div class="file-info">SVG, PNG, JPG or GIF (max. 5MB)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 30px;">
                            <button type="submit" class="btn btn-primary" id="saveProfile">
                                <i class="fas fa-save"></i>
                                <span>Save Changes</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Security Settings -->
            <div class="settings-content" id="securityContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-shield-alt"></i>
                        <h2>Security Settings</h2>
                    </div>
                    
                    <div class="security-status">
                        <div class="security-status-header">
                            <i class="fas fa-check-circle"></i>
                            <h3>Security Status: Good</h3>
                        </div>
                        
                        <div class="security-status-item">
                            <div class="security-info">
                                <div class="security-icon success">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="security-text">
                                    <h4>Password Strength</h4>
                                    <p>Your password is strong</p>
                                </div>
                            </div>
                            <button class="btn btn-secondary" id="changePasswordBtn">Change</button>
                        </div>
                        
                        <div class="security-status-item">
                            <div class="security-info">
                                <div class="security-icon success">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="security-text">
                                    <h4>Two-Factor Authentication</h4>
                                    <p>Enabled for extra security</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="twoFactorAuth" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="security-status-item">
                            <div class="security-info">
                                <div class="security-icon warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="security-text">
                                    <h4>Login Notifications</h4>
                                    <p>Get notified of new logins</p>
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="loginNotifications" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: white; margin-bottom: 20px;">Login History</h3>
                        <div class="activity-log" id="loginHistory">
                            <!-- Login history will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Notification Settings -->
            <div class="settings-content" id="notificationsContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-bell"></i>
                        <h2>Notification Preferences</h2>
                    </div>
                    
                    <form id="notificationsForm">
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">Email Notifications</h3>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="emailPortfolio" checked>
                                <label for="emailPortfolio">Portfolio updates and performance reports</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="emailMarket" checked>
                                <label for="emailMarket">Market insights and research reports</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="emailTransactions" checked>
                                <label for="emailTransactions">Transaction confirmations and statements</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="emailNewsletter" checked>
                                <label for="emailNewsletter">Weekly newsletter and investment tips</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="emailPromotional">
                                <label for="emailPromotional">Promotional offers and product updates</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">Push Notifications</h3>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pushPrice" checked>
                                <label for="pushPrice">Price alerts and significant movements</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pushDividend" checked>
                                <label for="pushDividend">Dividend declarations and payouts</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pushSIP">
                                <label for="pushSIP">SIP reminders and processing updates</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pushGoals" checked>
                                <label for="pushGoals">Goal progress and milestone achievements</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">SMS Notifications</h3>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="smsOTP" checked>
                                <label for="smsOTP">OTP for login and transactions</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="smsCritical">
                                <label for="smsCritical">Critical alerts and security notifications</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="smsBalance">
                                <label for="smsBalance">Account balance and large transactions</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="notificationFrequency">Notification Frequency</label>
                            <select id="notificationFrequency" class="form-control">
                                <option value="realtime">Real-time (immediately)</option>
                                <option value="daily" selected>Daily Digest</option>
                                <option value="weekly">Weekly Summary</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="margin-top: 30px;">
                            <button type="submit" class="btn btn-primary" id="saveNotifications">
                                <i class="fas fa-save"></i>
                                <span>Save Notification Settings</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Preferences Settings -->
            <div class="settings-content" id="preferencesContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-sliders-h"></i>
                        <h2>Account Preferences</h2>
                    </div>
                    
                    <form id="preferencesForm">
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">Display Preferences</h3>
                            
                            <div class="form-group">
                                <label for="theme">Theme</label>
                                <select id="theme" class="form-control">
                                    <option value="dark">Dark Theme</option>
                                    <option value="light">Light Theme</option>
                                    <option value="auto">Auto (System Default)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="language">Language</label>
                                <select id="language" class="form-control">
                                    <option value="en">English</option>
                                    <option value="hi">Hindi</option>
                                    <option value="ta">Tamil</option>
                                    <option value="te">Telugu</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="timezone">Timezone</label>
                                <select id="timezone" class="form-control">
                                    <option value="IST">Indian Standard Time (IST)</option>
                                    <option value="UTC">UTC</option>
                                    <option value="EST">Eastern Standard Time</option>
                                    <option value="PST">Pacific Standard Time</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="currency">Default Currency</label>
                                <select id="currency" class="form-control">
                                    <option value="INR" selected>Indian Rupee (â‚¹)</option>
                                    <option value="USD">US Dollar ($)</option>
                                    <option value="EUR">Euro (â‚¬)</option>
                                    <option value="GBP">British Pound (Â£)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="dateFormat">Date Format</label>
                                <select id="dateFormat" class="form-control">
                                    <option value="dd-mm-yyyy">DD-MM-YYYY</option>
                                    <option value="mm-dd-yyyy">MM-DD-YYYY</option>
                                    <option value="yyyy-mm-dd">YYYY-MM-DD</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">Investment Preferences</h3>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="autoSync" checked>
                                <label for="autoSync">Auto-sync portfolio data daily</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="showAdvanced" checked>
                                <label for="showAdvanced">Show advanced analytics</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="riskProfile">
                                <label for="riskProfile">Update risk profile automatically</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="taxOptimization" checked>
                                <label for="taxOptimization">Enable tax optimization suggestions</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <h3 style="color: white; margin-bottom: 15px;">Data & Privacy</h3>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="dataCollection" checked>
                                <label for="dataCollection">Allow anonymous data collection for improvement</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="personalizedAds">
                                <label for="personalizedAds">Show personalized recommendations</label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="shareData">
                                <label for="shareData">Share data with research partners (anonymized)</label>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 30px;">
                            <button type="submit" class="btn btn-primary" id="savePreferences">
                                <i class="fas fa-save"></i>
                                <span>Save Preferences</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Subscription Settings -->
            <div class="settings-content" id="subscriptionContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-crown"></i>
                        <h2>Subscription Plan</h2>
                    </div>
                    
                    <div class="plan-card">
                        <div class="plan-header">
                            <h3>Premium Plan</h3>
                            <div class="plan-price">â‚¹999/month</div>
                        </div>
                        
                        <ul class="plan-features">
                            <li><i class="fas fa-check"></i> Unlimited portfolio tracking</li>
                            <li><i class="fas fa-check"></i> Advanced analytics and insights</li>
                            <li><i class="fas fa-check"></i> Tax optimization features</li>
                            <li><i class="fas fa-check"></i> Priority customer support</li>
                            <li><i class="fas fa-check"></i> Custom report generation</li>
                            <li><i class="fas fa-check"></i> Real-time market data</li>
                        </ul>
                        
                        <div class="form-group">
                            <button class="btn btn-primary" id="upgradePlan">
                                <i class="fas fa-rocket"></i>
                                <span>Upgrade to Pro</span>
                            </button>
                            <button class="btn btn-secondary" id="downgradePlan" style="margin-left: 10px;">
                                <i class="fas fa-arrow-down"></i>
                                <span>Downgrade to Free</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: white; margin-bottom: 15px;">Billing Information</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="billingName">Name on Card</label>
                                <input type="text" id="billingName" class="form-control" value="Demo User">
                            </div>
                            
                            <div class="form-group">
                                <label for="cardNumber">Card Number</label>
                                <input type="text" id="cardNumber" class="form-control" value="**** **** **** 1234" disabled>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expiryDate">Expiry Date</label>
                                <input type="text" id="expiryDate" class="form-control" value="12/25" disabled>
                            </div>
                            
                            <div class="form-group">
                                <label for="cvv">CVV</label>
                                <input type="text" id="cvv" class="form-control" placeholder="***" disabled>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-secondary" id="updateBilling">
                                <i class="fas fa-credit-card"></i>
                                <span>Update Billing Information</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: white; margin-bottom: 15px;">Billing History</h3>
                        <div class="activity-log" id="billingHistory">
                            <!-- Billing history will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Connected Apps -->
            <div class="settings-content" id="connectedAppsContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-plug"></i>
                        <h2>Connected Applications</h2>
                    </div>
                    
                    <div class="connected-apps" id="appsList">
                        <!-- Connected apps will be loaded here -->
                    </div>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: white; margin-bottom: 15px;">Available Integrations</h3>
                        
                        <div class="connected-apps">
                            <div class="app-card">
                                <div class="app-icon" style="background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);">
                                    <i class="fas fa-file-excel"></i>
                                </div>
                                <div class="app-info">
                                    <h4>Google Sheets</h4>
                                    <p>Export portfolio data to Google Sheets</p>
                                </div>
                                <button class="btn btn-secondary">Connect</button>
                            </div>
                            
                            <div class="app-card">
                                <div class="app-icon" style="background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <div class="app-info">
                                    <h4>Zerodha Console</h4>
                                    <p>Sync with Zerodha trading account</p>
                                </div>
                                <button class="btn btn-secondary">Connect</button>
                            </div>
                            
                            <div class="app-card">
                                <div class="app-icon" style="background: linear-gradient(135deg, #FFD166 0%, #FFB347 100%);">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="app-info">
                                    <h4>QuickBooks</h4>
                                    <p>Export transactions to QuickBooks</p>
                                </div>
                                <button class="btn btn-secondary">Connect</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Privacy Settings -->
            <div class="settings-content" id="privacyContent">
                <div class="settings-card">
                    <div class="settings-card-header">
                        <i class="fas fa-lock"></i>
                        <h2>Privacy & Data</h2>
                    </div>
                    
                    <div class="form-group">
                        <h3 style="color: white; margin-bottom: 15px;">Data Management</h3>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="downloadData" checked>
                            <label for="downloadData">Allow data download in readable format</label>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="autoBackup" checked>
                            <label for="autoBackup">Automatically backup data weekly</label>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="dataRetention">
                            <label for="dataRetention">Retain deleted data for 30 days</label>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <button class="btn btn-secondary" id="exportDataBtn">
                                <i class="fas fa-download"></i>
                                <span>Export My Data</span>
                            </button>
                            <button class="btn btn-secondary" id="clearCache" style="margin-left: 10px;">
                                <i class="fas fa-broom"></i>
                                <span>Clear Cache</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="danger-zone">
                        <div class="danger-zone-header">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h2>Danger Zone</h2>
                        </div>
                        
                        <div class="danger-zone-item">
                            <div class="danger-zone-content">
                                <div class="danger-zone-info">
                                    <h4>Delete Account</h4>
                                    <p>Permanently delete your account and all data</p>
                                </div>
                                <button class="btn btn-danger" id="deleteAccountBtn">
                                    <i class="fas fa-trash-alt"></i>
                                    <span>Delete Account</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="danger-zone-item">
                            <div class="danger-zone-content">
                                <div class="danger-zone-info">
                                    <h4>Reset All Data</h4>
                                    <p>Clear all portfolio data and start fresh</p>
                                </div>
                                <button class="btn btn-danger" id="resetDataBtn">
                                    <i class="fas fa-redo"></i>
                                    <span>Reset Data</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="danger-zone-item">
                            <div class="danger-zone-content">
                                <div class="danger-zone-info">
                                    <h4>Revoke All Sessions</h4>
                                    <p>Log out from all devices and browsers</p>
                                </div>
                                <button class="btn btn-danger" id="revokeSessionsBtn">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Revoke Sessions</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ===== SETTINGS DATA =====
        const settingsData = {
            user: {
                name: 'Demo User',
                email: 'demo@infinityfunds.com',
                phone: '+91 98765 43210',
                address: 'Mumbai, India',
                dob: '1990-01-01',
                pan: 'ABCDE1234F'
            },
            
            security: {
                twoFactorEnabled: true,
                loginNotifications: true,
                lastPasswordChange: '2024-01-15'
            },
            
            notifications: {
                email: {
                    portfolio: true,
                    market: true,
                    transactions: true,
                    newsletter: true,
                    promotional: false
                },
                push: {
                    price: true,
                    dividend: true,
                    sip: false,
                    goals: true
                },
                sms: {
                    otp: true,
                    critical: false,
                    balance: false
                },
                frequency: 'daily'
            },
            
            preferences: {
                theme: 'dark',
                language: 'en',
                timezone: 'IST',
                currency: 'INR',
                dateFormat: 'dd-mm-yyyy',
                autoSync: true,
                showAdvanced: true,
                riskProfile: false,
                taxOptimization: true,
                dataCollection: true,
                personalizedAds: false,
                shareData: false
            },
            
            subscription: {
                plan: 'premium',
                price: 999,
                billingCycle: 'monthly',
                nextBilling: '2024-02-01'
            },
            
            connectedApps: [
                {
                    id: 1,
                    name: 'Google Drive',
                    icon: 'fas fa-hdd',
                    color: '#4285F4',
                    description: 'Backup portfolio data to Google Drive',
                    connected: true,
                    lastUsed: '2 days ago'
                },
                {
                    id: 2,
                    name: 'Dropbox',
                    icon: 'fas fa-cloud',
                    color: '#0061FF',
                    description: 'Sync reports to Dropbox',
                    connected: true,
                    lastUsed: '1 week ago'
                },
                {
                    id: 3,
                    name: 'Slack',
                    icon: 'fab fa-slack',
                    color: '#4A154B',
                    description: 'Send alerts to Slack',
                    connected: false,
                    lastUsed: 'Never'
                }
            ],
            
            loginHistory: [
                {
                    id: 1,
                    type: 'login',
                    device: 'Chrome on Windows',
                    location: 'Mumbai, India',
                    time: '2024-01-20 10:30 AM',
                    status: 'success'
                },
                {
                    id: 2,
                    type: 'login',
                    device: 'Safari on iPhone',
                    location: 'Delhi, India',
                    time: '2024-01-19 09:15 PM',
                    status: 'success'
                },
                {
                    id: 3,
                    type: 'password',
                    device: 'Chrome on Windows',
                    location: 'Mumbai, India',
                    time: '2024-01-15 02:45 PM',
                    status: 'changed'
                },
                {
                    id: 4,
                    type: 'login',
                    device: 'Firefox on Mac',
                    location: 'Bangalore, India',
                    time: '2024-01-14 11:20 AM',
                    status: 'success'
                },
                {
                    id: 5,
                    type: 'device',
                    device: 'Android App',
                    location: 'Chennai, India',
                    time: '2024-01-10 08:30 PM',
                    status: 'new'
                }
            ],
            
            billingHistory: [
                {
                    id: 1,
                    date: '2024-01-01',
                    amount: 999,
                    description: 'Premium Plan - Monthly',
                    status: 'paid'
                },
                {
                    id: 2,
                    date: '2023-12-01',
                    amount: 999,
                    description: 'Premium Plan - Monthly',
                    status: 'paid'
                },
                {
                    id: 3,
                    date: '2023-11-01',
                    amount: 999,
                    description: 'Premium Plan - Monthly',
                    status: 'paid'
                },
                {
                    id: 4,
                    date: '2023-10-01',
                    amount: 0,
                    description: 'Free Trial',
                    status: 'free'
                }
            ]
        };

        // ===== SETTINGS INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Settings page loaded - Initializing...');
            
            // DOM Elements
            const sidebar = document.getElementById('sidebar');
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const notification = document.getElementById('notification');
            const notificationMessage = document.getElementById('notificationMessage');
            const sidebarLogout = document.getElementById('sidebarLogout');
            const settingsUserName = document.getElementById('settingsUserName');
            const settingsUserEmail = document.getElementById('settingsUserEmail');
            const settingsUserAvatar = document.getElementById('settingsUserAvatar');
            const avatarText = document.getElementById('avatarText');
            const settingsUserPlan = document.getElementById('settingsUserPlan');
            
            // Settings tabs
            const settingsTabs = document.querySelectorAll('.settings-tab');
            const settingsContents = document.querySelectorAll('.settings-content');
            
            // Modal Elements
            const changePasswordModal = document.getElementById('changePasswordModal');
            const deleteAccountModal = document.getElementById('deleteAccountModal');
            const exportDataModal = document.getElementById('exportDataModal');
            const closePasswordModal = document.getElementById('closePasswordModal');
            const closeDeleteModal = document.getElementById('closeDeleteModal');
            const closeExportModal = document.getElementById('closeExportModal');
            const cancelPasswordChange = document.getElementById('cancelPasswordChange');
            const cancelDeleteAccount = document.getElementById('cancelDeleteAccount');
            const cancelExport = document.getElementById('cancelExport');
            const changePasswordForm = document.getElementById('changePasswordForm');
            const confirmDeleteAccount = document.getElementById('confirmDeleteAccount');
            const startExport = document.getElementById('startExport');
            
            // Button Elements
            const changePasswordBtn = document.getElementById('changePasswordBtn');
            const deleteAccountBtn = document.getElementById('deleteAccountBtn');
            const exportDataBtn = document.getElementById('exportDataBtn');
            const clearCacheBtn = document.getElementById('clearCache');
            const resetDataBtn = document.getElementById('resetDataBtn');
            const revokeSessionsBtn = document.getElementById('revokeSessionsBtn');
            const upgradePlanBtn = document.getElementById('upgradePlan');
            const downgradePlanBtn = document.getElementById('downgradePlan');
            const updateBillingBtn = document.getElementById('updateBilling');
            
            // Form Elements
            const profileForm = document.getElementById('profileForm');
            const notificationsForm = document.getElementById('notificationsForm');
            const preferencesForm = document.getElementById('preferencesForm');
            const saveProfileBtn = document.getElementById('saveProfile');
            const saveNotificationsBtn = document.getElementById('saveNotifications');
            const savePreferencesBtn = document.getElementById('savePreferences');
            
            // Password strength elements
            const passwordStrengthBar = document.getElementById('passwordStrengthBar');
            const passwordStrengthText = document.getElementById('passwordStrengthText');
            const newPasswordInput = document.getElementById('newPassword');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const passwordError = document.getElementById('passwordError');
            
            // Delete confirmation checkboxes
            const confirmDeleteCheckbox = document.getElementById('confirmDelete');
            const confirmDataLossCheckbox = document.getElementById('confirmDataLoss');
            
            // ===== USER AUTHENTICATION CHECK =====
            function checkAuth() {
                try {
                    const userData = localStorage.getItem('infinity_user');
                    if (!userData) {
                        // No user found, redirect to login
                        showNotification('Please login to access settings', 'warning');
                        setTimeout(() => {
                            window.location.href = 'index.html';
                        }, 2000);
                        return null;
                    }
                    
                    const user = JSON.parse(userData);
                    
                    // Update UI with user data
                    if (settingsUserName) {
                        settingsUserName.textContent = user.name;
                    }
                    
                    if (settingsUserEmail) {
                        settingsUserEmail.textContent = user.email;
                    }
                    
                    if (avatarText) {
                        const initials = user.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                        avatarText.textContent = initials;
                    }
                    
                    if (settingsUserPlan) {
                        settingsUserPlan.textContent = user.plan || 'Premium';
                    }
                    
                    return user;
                } catch (error) {
                    console.error('Auth check error:', error);
                    return null;
                }
            }
            
            const currentUser = checkAuth();
            
            // ===== INITIALIZE SETTINGS =====
            function initSettings() {
                // Load user data into forms
                loadUserData();
                
                // Load security settings
                loadSecuritySettings();
                
                // Load notification settings
                loadNotificationSettings();
                
                // Load preference settings
                loadPreferenceSettings();
                
                // Load connected apps
                loadConnectedApps();
                
                // Load login history
                loadLoginHistory();
                
                // Load billing history
                loadBillingHistory();
                
                // Initialize event listeners
                initEventListeners();
            }
            
            // ===== LOAD USER DATA =====
            function loadUserData() {
                // Profile form
                if (document.getElementById('firstName')) {
                    document.getElementById('firstName').value = settingsData.user.name.split(' ')[0] || '';
                }
                
                if (document.getElementById('lastName')) {
                    document.getElementById('lastName').value = settingsData.user.name.split(' ').slice(1).join(' ') || '';
                }
                
                if (document.getElementById('email')) {
                    document.getElementById('email').value = settingsData.user.email;
                }
                
                if (document.getElementById('phone')) {
                    document.getElementById('phone').value = settingsData.user.phone;
                }
                
                if (document.getElementById('address')) {
                    document.getElementById('address').value = settingsData.user.address;
                }
                
                if (document.getElementById('dob')) {
                    document.getElementById('dob').value = settingsData.user.dob;
                }
                
                if (document.getElementById('pan')) {
                    document.getElementById('pan').value = settingsData.user.pan;
                }
            }
            
            // ===== LOAD SECURITY SETTINGS =====
            function loadSecuritySettings() {
                if (document.getElementById('twoFactorAuth')) {
                    document.getElementById('twoFactorAuth').checked = settingsData.security.twoFactorEnabled;
                }
                
                if (document.getElementById('loginNotifications')) {
                    document.getElementById('loginNotifications').checked = settingsData.security.loginNotifications;
                }
            }
            
            // ===== LOAD NOTIFICATION SETTINGS =====
            function loadNotificationSettings() {
                // Email notifications
                document.getElementById('emailPortfolio').checked = settingsData.notifications.email.portfolio;
                document.getElementById('emailMarket').checked = settingsData.notifications.email.market;
                document.getElementById('emailTransactions').checked = settingsData.notifications.email.transactions;
                document.getElementById('emailNewsletter').checked = settingsData.notifications.email.newsletter;
                document.getElementById('emailPromotional').checked = settingsData.notifications.email.promotional;
                
                // Push notifications
                document.getElementById('pushPrice').checked = settingsData.notifications.push.price;
                document.getElementById('pushDividend').checked = settingsData.notifications.push.dividend;
                document.getElementById('pushSIP').checked = settingsData.notifications.push.sip;
                document.getElementById('pushGoals').checked = settingsData.notifications.push.goals;
                
                // SMS notifications
                document.getElementById('smsOTP').checked = settingsData.notifications.sms.otp;
                document.getElementById('smsCritical').checked = settingsData.notifications.sms.critical;
                document.getElementById('smsBalance').checked = settingsData.notifications.sms.balance;
                
                // Frequency
                document.getElementById('notificationFrequency').value = settingsData.notifications.frequency;
            }
            
            // ===== LOAD PREFERENCE SETTINGS =====
            function loadPreferenceSettings() {
                // Display preferences
                document.getElementById('theme').value = settingsData.preferences.theme;
                document.getElementById('language').value = settingsData.preferences.language;
                document.getElementById('timezone').value = settingsData.preferences.timezone;
                document.getElementById('currency').value = settingsData.preferences.currency;
                document.getElementById('dateFormat').value = settingsData.preferences.dateFormat;
                
                // Investment preferences
                document.getElementById('autoSync').checked = settingsData.preferences.autoSync;
                document.getElementById('showAdvanced').checked = settingsData.preferences.showAdvanced;
                document.getElementById('riskProfile').checked = settingsData.preferences.riskProfile;
                document.getElementById('taxOptimization').checked = settingsData.preferences.taxOptimization;
                
                // Data & privacy
                document.getElementById('dataCollection').checked = settingsData.preferences.dataCollection;
                document.getElementById('personalizedAds').checked = settingsData.preferences.personalizedAds;
                document.getElementById('shareData').checked = settingsData.preferences.shareData;
            }
            
            // ===== LOAD CONNECTED APPS =====
            function loadConnectedApps() {
                const appsList = document.getElementById('appsList');
                if (!appsList) return;
                
                appsList.innerHTML = '';
                
                settingsData.connectedApps.forEach(app => {
                    const appCard = document.createElement('div');
                    appCard.className = 'app-card';
                    
                    appCard.innerHTML = `
                        <div class="app-icon" style="background: ${app.color};">
                            <i class="${app.icon}"></i>
                        </div>
                        <div class="app-info">
                            <h4>${app.name}</h4>
                            <p>${app.description}</p>
                            <small style="color: #94a3b8;">Last used: ${app.lastUsed}</small>
                        </div>
                        <div class="app-actions">
                            ${app.connected ? 
                                `<button class="btn btn-secondary" data-app-id="${app.id}">Disconnect</button>` :
                                `<button class="btn btn-primary" data-app-id="${app.id}">Connect</button>`
                            }
                        </div>
                    `;
                    
                    appsList.appendChild(appCard);
                });
            }
            
            // ===== LOAD LOGIN HISTORY =====
            function loadLoginHistory() {
                const loginHistory = document.getElementById('loginHistory');
                if (!loginHistory) return;
                
                loginHistory.innerHTML = '';
                
                settingsData.loginHistory.forEach(log => {
                    let iconClass, iconBg;
                    
                    switch(log.type) {
                        case 'login':
                            iconClass = 'login';
                            iconBg = 'rgba(16, 185, 129, 0.2)';
                            break;
                        case 'password':
                            iconClass = 'password';
                            iconBg = 'rgba(59, 130, 246, 0.2)';
                            break;
                        case 'device':
                            iconClass = 'device';
                            iconBg = 'rgba(168, 85, 247, 0.2)';
                            break;
                        default:
                            iconClass = 'profile';
                            iconBg = 'rgba(245, 158, 11, 0.2)';
                    }
                    
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    
                    activityItem.innerHTML = `
                        <div class="activity-icon ${iconClass}" style="background: ${iconBg};">
                            <i class="fas fa-${log.type === 'login' ? 'sign-in-alt' : 
                                          log.type === 'password' ? 'key' :
                                          log.type === 'device' ? 'mobile-alt' : 'user'}"></i>
                        </div>
                        <div class="activity-details">
                            <h4>${log.device}</h4>
                            <p>${log.location} â€¢ ${log.status === 'success' ? 'Successful' : 
                               log.status === 'changed' ? 'Password changed' : 'New device'}</p>
                        </div>
                        <div class="activity-time">${log.time}</div>
                    `;
                    
                    loginHistory.appendChild(activityItem);
                });
            }
            
            // ===== LOAD BILLING HISTORY =====
            function loadBillingHistory() {
                const billingHistory = document.getElementById('billingHistory');
                if (!billingHistory) return;
                
                billingHistory.innerHTML = '';
                
                settingsData.billingHistory.forEach(bill => {
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    
                    activityItem.innerHTML = `
                        <div class="activity-icon" style="background: rgba(59, 130, 246, 0.2); color: #3b82f6;">
                            <i class="fas fa-${bill.status === 'free' ? 'gift' : 'receipt'}"></i>
                        </div>
                        <div class="activity-details">
                            <h4>${bill.description}</h4>
                            <p>${bill.date}</p>
                        </div>
                        <div class="activity-time" style="color: ${bill.status === 'paid' ? '#10b981' : '#94a3b8'}">
                            ${bill.status === 'free' ? 'Free' : `â‚¹${bill.amount}`}
                        </div>
                    `;
                    
                    billingHistory.appendChild(activityItem);
                });
            }
            
            // ===== EVENT LISTENERS =====
            function initEventListeners() {
                // Mobile menu toggle
                if (mobileMenuToggle) {
                    mobileMenuToggle.addEventListener('click', function() {
                        sidebar.classList.toggle('active');
                    });
                }
                
                // Close sidebar when clicking outside on mobile
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 1024) {
                        if (!sidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                            sidebar.classList.remove('active');
                        }
                    }
                });
                
                // Logout
                if (sidebarLogout) {
                    sidebarLogout.addEventListener('click', function(e) {
                        e.preventDefault();
                        if (confirm('Are you sure you want to sign out?')) {
                            localStorage.removeItem('infinity_user');
                            showNotification('Signed out successfully', 'success');
                            setTimeout(() => {
                                window.location.href = 'index.html';
                            }, 1500);
                        }
                    });
                }
                
                // Settings tabs
                settingsTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabName = this.dataset.tab;
                        
                        // Update active tab
                        settingsTabs.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Show corresponding content
                        settingsContents.forEach(content => {
                            content.classList.remove('active');
                            if (content.id === tabName + 'Content') {
                                content.classList.add('active');
                            }
                        });
                    });
                });
                
                // Modal open buttons
                if (changePasswordBtn) {
                    changePasswordBtn.addEventListener('click', function() {
                        openModal(changePasswordModal);
                    });
                }
                
                if (deleteAccountBtn) {
                    deleteAccountBtn.addEventListener('click', function() {
                        openModal(deleteAccountModal);
                    });
                }
                
                if (exportDataBtn) {
                    exportDataBtn.addEventListener('click', function() {
                        openModal(exportDataModal);
                    });
                }
                
                // Modal close buttons
                if (closePasswordModal) {
                    closePasswordModal.addEventListener('click', function() {
                        closeModal(changePasswordModal);
                    });
                }
                
                if (closeDeleteModal) {
                    closeDeleteModal.addEventListener('click', function() {
                        closeModal(deleteAccountModal);
                    });
                }
                
                if (closeExportModal) {
                    closeExportModal.addEventListener('click', function() {
                        closeModal(exportDataModal);
                    });
                }
                
                if (cancelPasswordChange) {
                    cancelPasswordChange.addEventListener('click', function() {
                        closeModal(changePasswordModal);
                    });
                }
                
                if (cancelDeleteAccount) {
                    cancelDeleteAccount.addEventListener('click', function() {
                        closeModal(deleteAccountModal);
                    });
                }
                
                if (cancelExport) {
                    cancelExport.addEventListener('click', function() {
                        closeModal(exportDataModal);
                    });
                }
                
                // Close modals when clicking outside
                window.addEventListener('click', function(e) {
                    if (e.target === changePasswordModal) closeModal(changePasswordModal);
                    if (e.target === deleteAccountModal) closeModal(deleteAccountModal);
                    if (e.target === exportDataModal) closeModal(exportDataModal);
                });
                
                // Form submissions
                if (profileForm) {
                    profileForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        saveProfileSettings();
                    });
                }
                
                if (notificationsForm) {
                    notificationsForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        saveNotificationSettings();
                    });
                }
                
                if (preferencesForm) {
                    preferencesForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        savePreferenceSettings();
                    });
                }
                
                if (changePasswordForm) {
                    changePasswordForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        changePassword();
                    });
                }
                
                // Password strength check
                if (newPasswordInput) {
                    newPasswordInput.addEventListener('input', function() {
                        checkPasswordStrength(this.value);
                        validatePasswordMatch();
                    });
                }
                
                if (confirmPasswordInput) {
                    confirmPasswordInput.addEventListener('input', validatePasswordMatch);
                }
                
                // Delete account confirmation
                if (confirmDeleteCheckbox && confirmDataLossCheckbox) {
                    confirmDeleteCheckbox.addEventListener('change', updateDeleteButton);
                    confirmDataLossCheckbox.addEventListener('change', updateDeleteButton);
                }
                
                if (confirmDeleteAccount) {
                    confirmDeleteAccount.addEventListener('click', deleteAccount);
                }
                
                // Export data
                if (startExport) {
                    startExport.addEventListener('click', exportData);
                }
                
                // Action buttons
                if (clearCacheBtn) {
                    clearCacheBtn.addEventListener('click', function() {
                        if (confirm('Clear all cached data?')) {
                            showNotification('Cache cleared successfully', 'success');
                        }
                    });
                }
                
                if (resetDataBtn) {
                    resetDataBtn.addEventListener('click', function() {
                        if (confirm('This will reset all your portfolio data. Are you sure?')) {
                            showNotification('Portfolio data reset', 'info');
                        }
                    });
                }
                
                if (revokeSessionsBtn) {
                    revokeSessionsBtn.addEventListener('click', function() {
                        if (confirm('This will log you out from all devices. Continue?')) {
                            showNotification('All sessions revoked', 'success');
                        }
                    });
                }
                
                if (upgradePlanBtn) {
                    upgradePlanBtn.addEventListener('click', function() {
                        showNotification('Plan upgrade feature coming soon!', 'info');
                    });
                }
                
                if (downgradePlanBtn) {
                    downgradePlanBtn.addEventListener('click', function() {
                        if (confirm('Downgrade to free plan?')) {
                            showNotification('Plan downgraded to Free', 'info');
                        }
                    });
                }
                
                if (updateBillingBtn) {
                    updateBillingBtn.addEventListener('click', function() {
                        showNotification('Billing update feature coming soon!', 'info');
                    });
                }
                
                // Profile picture upload
                const profilePictureInput = document.getElementById('profilePicture');
                if (profilePictureInput) {
                    profilePictureInput.addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if (file) {
                            if (file.size > 5 * 1024 * 1024) {
                                showNotification('File size must be less than 5MB', 'error');
                                this.value = '';
                                return;
                            }
                            
                            if (!file.type.match('image.*')) {
                                showNotification('Please select an image file', 'error');
                                this.value = '';
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                settingsUserAvatar.src = e.target.result;
                                showNotification('Profile picture updated successfully', 'success');
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                }
            }
            
            // ===== PASSWORD STRENGTH CHECK =====
            function checkPasswordStrength(password) {
                if (!passwordStrengthBar || !passwordStrengthText) return;
                
                let strength = 0;
                let text = 'Password strength';
                let className = 'weak';
                
                // Check length
                if (password.length >= 8) strength++;
                if (password.length >= 12) strength++;
                
                // Check for mixed case
                if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
                
                // Check for numbers
                if (/\d/.test(password)) strength++;
                
                // Check for special characters
                if (/[^A-Za-z0-9]/.test(password)) strength++;
                
                // Determine strength level
                if (strength <= 1) {
                    text = 'Weak';
                    className = 'weak';
                } else if (strength === 2) {
                    text = 'Fair';
                    className = 'fair';
                } else if (strength === 3) {
                    text = 'Good';
                    className = 'good';
                } else if (strength >= 4) {
                    text = 'Strong';
                    className = 'strong';
                }
                
                // Update UI
                passwordStrengthBar.className = `strength-bar ${className}`;
                passwordStrengthText.textContent = text;
            }
            
            // ===== VALIDATE PASSWORD MATCH =====
            function validatePasswordMatch() {
                if (!newPasswordInput || !confirmPasswordInput || !passwordError) return;
                
                const password = newPasswordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                
                if (confirmPassword && password !== confirmPassword) {
                    passwordError.style.display = 'block';
                    return false;
                } else {
                    passwordError.style.display = 'none';
                    return true;
                }
            }
            
            // ===== UPDATE DELETE BUTTON =====
            function updateDeleteButton() {
                if (!confirmDeleteAccount) return;
                
                const isConfirmed = confirmDeleteCheckbox.checked && confirmDataLossCheckbox.checked;
                confirmDeleteAccount.disabled = !isConfirmed;
            }
            
            // ===== MODAL FUNCTIONS =====
            function openModal(modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
            
            function closeModal(modal) {
                modal.classList.remove('show');
                document.body.style.overflow = '';
                
                // Reset forms
                if (modal === changePasswordModal) {
                    changePasswordForm.reset();
                    passwordStrengthBar.className = 'strength-bar';
                    passwordStrengthText.textContent = 'Password strength';
                    passwordError.style.display = 'none';
                }
                
                if (modal === deleteAccountModal) {
                    confirmDeleteCheckbox.checked = false;
                    confirmDataLossCheckbox.checked = false;
                    document.getElementById('deleteReason').value = '';
                    updateDeleteButton();
                }
            }
            
            // ===== SAVE PROFILE SETTINGS =====
            function saveProfileSettings() {
                const submitBtn = saveProfileBtn;
                const originalText = submitBtn.innerHTML;
                
                // Show loading
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading"></span> Saving...';
                
                // Simulate API call
                setTimeout(() => {
                    // Update settings data
                    settingsData.user.name = `${document.getElementById('firstName').value} ${document.getElementById('lastName').value}`;
                    settingsData.user.email = document.getElementById('email').value;
                    settingsData.user.phone = document.getElementById('phone').value;
                    settingsData.user.address = document.getElementById('address').value;
                    settingsData.user.dob = document.getElementById('dob').value;
                    settingsData.user.pan = document.getElementById('pan').value.toUpperCase();
                    
                    // Update UI
                    settingsUserName.textContent = settingsData.user.name;
                    settingsUserEmail.textContent = settingsData.user.email;
                    
                    // Update localStorage
                    const userData = JSON.parse(localStorage.getItem('infinity_user') || '{}');
                    userData.name = settingsData.user.name;
                    userData.email = settingsData.user.email;
                    localStorage.setItem('infinity_user', JSON.stringify(userData));
                    
                    // Show success message
                    showNotification('Profile updated successfully', 'success');
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                }, 1500);
            }
            
            // ===== SAVE NOTIFICATION SETTINGS =====
            function saveNotificationSettings() {
                const submitBtn = saveNotificationsBtn;
                const originalText = submitBtn.innerHTML;
                
                // Show loading
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading"></span> Saving...';
                
                // Simulate API call
                setTimeout(() => {
                    // Update settings data
                    settingsData.notifications.email.portfolio = document.getElementById('emailPortfolio').checked;
                    settingsData.notifications.email.market = document.getElementById('emailMarket').checked;
                    settingsData.notifications.email.transactions = document.getElementById('emailTransactions').checked;
                    settingsData.notifications.email.newsletter = document.getElementById('emailNewsletter').checked;
                    settingsData.notifications.email.promotional = document.getElementById('emailPromotional').checked;
                    
                    settingsData.notifications.push.price = document.getElementById('pushPrice').checked;
                    settingsData.notifications.push.dividend = document.getElementById('pushDividend').checked;
                    settingsData.notifications.push.sip = document.getElementById('pushSIP').checked;
                    settingsData.notifications.push.goals = document.getElementById('pushGoals').checked;
                    
                    settingsData.notifications.sms.otp = document.getElementById('smsOTP').checked;
                    settingsData.notifications.sms.critical = document.getElementById('smsCritical').checked;
                    settingsData.notifications.sms.balance = document.getElementById('smsBalance').checked;
                    
                    settingsData.notifications.frequency = document.getElementById('notificationFrequency').value;
                    
                    // Show success message
                    showNotification('Notification settings saved', 'success');
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                }, 1500);
            }
            
            // ===== SAVE PREFERENCE SETTINGS =====
            function savePreferenceSettings() {
                const submitBtn = savePreferencesBtn;
                const originalText = submitBtn.innerHTML;
                
                // Show loading
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading"></span> Saving...';
                
                // Simulate API call
                setTimeout(() => {
                    // Update settings data
                    settingsData.preferences.theme = document.getElementById('theme').value;
                    settingsData.preferences.language = document.getElementById('language').value;
                    settingsData.preferences.timezone = document.getElementById('timezone').value;
                    settingsData.preferences.currency = document.getElementById('currency').value;
                    settingsData.preferences.dateFormat = document.getElementById('dateFormat').value;
                    
                    settingsData.preferences.autoSync = document.getElementById('autoSync').checked;
                    settingsData.preferences.showAdvanced = document.getElementById('showAdvanced').checked;
                    settingsData.preferences.riskProfile = document.getElementById('riskProfile').checked;
                    settingsData.preferences.taxOptimization = document.getElementById('taxOptimization').checked;
                    
                    settingsData.preferences.dataCollection = document.getElementById('dataCollection').checked;
                    settingsData.preferences.personalizedAds = document.getElementById('personalizedAds').checked;
                    settingsData.preferences.shareData = document.getElementById('shareData').checked;
                    
                    // Show success message
                    showNotification('Preferences saved', 'success');
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                }, 1500);
            }
            
            // ===== CHANGE PASSWORD =====
            function changePassword() {
                if (!validatePasswordMatch()) {
                    showNotification('Passwords do not match', 'error');
                    return;
                }
                
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                
                if (!currentPassword || !newPassword) {
                    showNotification('Please fill all fields', 'error');
                    return;
                }
                
                if (newPassword.length < 8) {
                    showNotification('Password must be at least 8 characters', 'error');
                    return;
                }
                
                const submitBtn = document.getElementById('submitPasswordChange');
                const submitText = document.getElementById('submitPasswordText');
                const submitLoading = document.getElementById('submitPasswordLoading');
                
                // Show loading
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.style.display = 'inline-block';
                
                // Simulate API call
                setTimeout(() => {
                    // In a real app, you would verify current password with backend
                    if (currentPassword !== 'demo123') {
                        showNotification('Current password is incorrect', 'error');
                    } else {
                        // Update password in localStorage (for demo purposes)
                        const users = JSON.parse(localStorage.getItem('infinity_users') || '[]');
                        const userIndex = users.findIndex(u => u.email === settingsData.user.email);
                        
                        if (userIndex !== -1) {
                            users[userIndex].password = newPassword;
                            localStorage.setItem('infinity_users', JSON.stringify(users));
                        }
                        
                        // Update security data
                        settingsData.security.lastPasswordChange = new Date().toISOString().split('T')[0];
                        
                        // Close modal and show success
                        closeModal(changePasswordModal);
                        showNotification('Password changed successfully', 'success');
                    }
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitText.style.display = 'inline';
                    submitLoading.style.display = 'none';
                }, 2000);
            }
            
            // ===== DELETE ACCOUNT =====
            function deleteAccount() {
                const submitBtn = confirmDeleteAccount;
                const submitText = document.getElementById('deleteAccountText');
                const submitLoading = document.getElementById('deleteAccountLoading');
                
                // Show loading
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.style.display = 'inline-block';
                
                // Simulate API call
                setTimeout(() => {
                    // Clear user data
                    localStorage.removeItem('infinity_user');
                    
                    // Show success message
                    showNotification('Account deleted successfully', 'success');
                    
                    // Redirect to home page
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 2000);
                }, 3000);
            }
            
            // ===== EXPORT DATA =====
            function exportData() {
                const submitBtn = startExport;
                const submitText = document.getElementById('exportText');
                const submitLoading = document.getElementById('exportLoading');
                
                // Show loading
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.style.display = 'inline-block';
                
                // Simulate export process
                setTimeout(() => {
                    // Get selected options
                    const format = document.getElementById('exportFormat').value;
                    const dateRange = document.getElementById('dateRange').value;
                    
                    // Create export data
                    const exportData = {
                        user: settingsData.user,
                        portfolio: {
                            // In real app, this would contain actual portfolio data
                            holdings: settingsData.connectedApps.length + 5, // Example count
                            lastUpdated: new Date().toISOString()
                        },
                        exportDate: new Date().toISOString(),
                        format: format,
                        dateRange: dateRange
                    };
                    
                    // Create download link
                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `infinity-funds-export-${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    // Close modal
                    closeModal(exportDataModal);
                    
                    // Show success message
                    showNotification('Data exported successfully', 'success');
                    
                    // Reset button
                    submitBtn.disabled = false;
                    submitText.style.display = 'inline';
                    submitLoading.style.display = 'none';
                }, 2500);
            }
            
            // ===== UTILITY FUNCTIONS =====
            function showNotification(message, type = 'success') {
                if (!notification || !notificationMessage) return;
                
                // Set message
                notificationMessage.textContent = message;
                
                // Set color based on type
                const colors = {
                    success: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                    warning: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
                    error: 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)',
                    info: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)'
                };
                
                notification.style.background = colors[type] || colors.success;
                
                // Show notification
                notification.classList.add('show');
                
                // Auto hide after 5 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 5000);
            }
            
            // ===== INITIALIZE SETTINGS =====
            if (currentUser) {
                initSettings();
            }
        });
    </script>
</body>
</html>